<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WeCut - O corte perfeito, a um clique de voc√™</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
        .wecut-shadow {
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
        }
        .wecut-button-hover:hover {
            transform: translateY(-1px);
            transition: all 0.2s ease;
        }
        .hidden {
            display: none;
        }
        .active-page {
            display: block;
        }
        .active-nav {
            background-color: #f9fafb;
        }
        .rating-stars {
            display: inline-flex;
            gap: 2px;
            flex-direction: row-reverse;
        }
        .rating-stars input {
            display: none;
        }
        .rating-stars label {
            cursor: pointer;
            color: #d1d5db;
            transition: color 0.2s;
        }
        .rating-stars input:checked ~ label,
        .rating-stars label:hover,
        .rating-stars label:hover ~ label {
            color: #fbbf24;
        }
    </style>
</head>
<body class="min-h-screen bg-white">
    <!-- Navigation -->
    <nav id="navigation" class="border-b border-gray-200 bg-white wecut-shadow">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex items-center justify-between h-16">
                <!-- Logo -->
                <div class="flex items-center cursor-pointer" id="logo">
                    <h1 class="text-2xl font-medium text-black">WeCut</h1>
                    <span class="ml-3 text-sm text-gray-600 hidden sm:block">O corte perfeito, a um clique de voc√™</span>
                </div>

                <!-- Desktop Navigation -->
                <div class="hidden md:flex items-center space-x-8" id="desktop-nav">
                    <!-- Client Navigation -->
                    <div id="client-nav">
                        <button class="px-3 py-2 rounded-md text-sm font-medium text-black hover:bg-gray-50 wecut-button-hover nav-link" data-view="home-page">In√≠cio</button>
                        <button class="px-3 py-2 rounded-md text-sm font-medium text-black hover:bg-gray-50 wecut-button-hover nav-link" data-view="search-page">
                            <i data-lucide="search" class="w-4 h-4 inline mr-2"></i>
                            Buscar
                        </button>
                        <button class="px-3 py-2 rounded-md text-sm font-medium text-black hover:bg-gray-50 wecut-button-hover nav-link" data-view="appointments-page">
                            <i data-lucide="calendar" class="w-4 h-4 inline mr-2"></i>
                            Agendamentos
                        </button>
                    </div>
                    
                    <!-- Professional Navigation -->
                    <div id="professional-nav" class="hidden">
                        <button class="px-3 py-2 rounded-md text-sm font-medium text-black hover:bg-gray-50 wecut-button-hover nav-link" data-view="professional-dashboard-page">Dashboard</button>
                    </div>

                    <!-- Admin Navigation -->
                    <div id="admin-nav" class="hidden">
                        <button class="px-3 py-2 rounded-md text-sm font-medium text-black hover:bg-gray-50 wecut-button-hover nav-link" data-view="admin-dashboard-page">Dashboard Admin</button>
                    </div>
                </div>

                <!-- Right Side - Auth and User Type -->
                <div class="flex items-center space-x-4">
                    <!-- Auth Buttons (n√£o logado) -->
                    <div class="hidden sm:flex items-center space-x-2" id="auth-buttons">
                        <button class="px-4 py-2 text-sm text-black hover:bg-gray-50 rounded-md wecut-button-hover" id="login-btn">Entrar</button>
                        <button class="px-4 py-2 text-sm bg-black text-white hover:bg-gray-800 rounded-md wecut-button-hover" id="signup-btn">Cadastrar</button>
                    </div>

                    <!-- User Menu (logado) -->
                    <div id="user-menu" class="hidden">
                        <div class="flex items-center space-x-2">
                            <span id="user-name" class="text-sm text-black"></span>
                            <button id="logout-btn" class="px-3 py-1 text-sm text-black hover:bg-gray-50 rounded-md wecut-button-hover">Sair</button>
                        </div>
                    </div>

                    <!-- Mobile Menu -->
                    <button class="md:hidden text-black hover:bg-gray-50 p-2 rounded-md" id="mobile-menu-btn">
                        <i data-lucide="menu" class="w-5 h-5"></i>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Page Sections -->
    <div id="page-container">
        <!-- Conte√∫do ser√° carregado dinamicamente via JavaScript -->
    </div>

    <!-- Modals -->
    <div id="professional-details-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg p-6 max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 id="professional-details-title" class="text-xl font-bold text-black">Detalhes do Profissional</h3>
                <button onclick="closeProfessionalDetailsModal()" class="text-gray-500 hover:text-gray-700">
                    <i data-lucide="x" class="w-6 h-6"></i>
                </button>
            </div>
            <div id="professional-details-content" class="space-y-4">
                <!-- Conte√∫do ser√° preenchido dinamicamente -->
            </div>
            <div class="mt-6 flex justify-end space-x-3">
                <button id="remove-from-details" class="bg-red-600 text-white hover:bg-red-700 px-4 py-2 rounded wecut-button-hover">
                    Remover Profissional
                </button>
                <button onclick="closeProfessionalDetailsModal()" class="border border-gray-300 hover:bg-gray-50 px-4 py-2 rounded wecut-button-hover">
                    Fechar
                </button>
            </div>
        </div>
    </div>

    <!-- Rating Modal -->
    <div id="rating-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg p-6 max-w-md w-full mx-4">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-black">Avaliar Servi√ßo</h3>
                <button onclick="closeRatingModal()" class="text-gray-500 hover:text-gray-700">
                    <i data-lucide="x" class="w-6 h-6"></i>
                </button>
            </div>
            <form id="rating-form" onsubmit="submitRating(event)">
                <input type="hidden" id="rating-appointment-id">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-black mb-2">Avalia√ß√£o</label>
                        <div class="rating-stars text-2xl">
                            <input type="radio" id="star5" name="rating" value="5">
                            <label for="star5">‚òÖ</label>
                            <input type="radio" id="star4" name="rating" value="4">
                            <label for="star4">‚òÖ</label>
                            <input type="radio" id="star3" name="rating" value="3">
                            <label for="star3">‚òÖ</label>
                            <input type="radio" id="star2" name="rating" value="2">
                            <label for="star2">‚òÖ</label>
                            <input type="radio" id="star1" name="rating" value="1">
                            <label for="star1">‚òÖ</label>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-black mb-2">Coment√°rio (opcional)</label>
                        <textarea id="rating-comment" rows="3" class="w-full p-3 border border-gray-300 rounded-lg focus:border-black focus:ring-0" placeholder="Compartilhe sua experi√™ncia..."></textarea>
                    </div>
                </div>
                <div class="mt-6 flex justify-end gap-3">
                    <button type="button" onclick="closeRatingModal()" class="border border-gray-300 hover:bg-gray-50 px-4 py-2 rounded wecut-button-hover">Cancelar</button>
                    <button type="submit" class="bg-black text-white hover:bg-gray-800 px-4 py-2 rounded wecut-button-hover">Enviar Avalia√ß√£o</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Scripts Globais -->
    <script>
        // State Manager
        class StateManager {
            constructor() {
                this.state = {
                    currentUser: null,
                    users: [],
                    professionals: [],
                    salons: [],
                    appointments: [],
                    reviews: [],
                    adminTab: 'professionals',
                    professionalTab: 'pending',
                    bookingProfessionalId: null
                };
            }

            init() {
                const savedState = localStorage.getItem('wecut-state');
                if (savedState) {
                    try {
                        const parsedState = JSON.parse(savedState);
                        this.state = { ...this.state, ...parsedState };
                        console.log('Estado restaurado do localStorage');
                    } catch (e) {
                        console.error('Erro ao restaurar estado, carregando dados de amostra:', e);
                        this.loadSampleData();
                    }
                } else {
                    console.log('Nenhum estado salvo, carregando dados de amostra');
                    this.loadSampleData();
                }
                this.saveState();
                console.log('Usu√°rios dispon√≠veis:', this.state.users);
            }

            loadSampleData() {
                this.state.users = [
                    { 
                        id: 1, 
                        name: 'Cliente Teste', 
                        email: 'client@example.com', 
                        type: 'client', 
                        password: 'client123' 
                    },
                    { 
                        id: 2, 
                        name: 'Administrador', 
                        email: 'admin@example.com', 
                        type: 'admin', 
                        password: 'admin123' 
                    },
                    { 
                        id: 3, 
                        name: 'Jo√£o Silva', 
                        email: 'pro@example.com', 
                        type: 'professional', 
                        password: 'pro123' 
                    }
                ];

                this.state.salons = [
                    {
                        id: 1,
                        userId: 3,
                        name: 'Barbearia Cl√°ssica',
                        location: 'Maputo',
                        phone: '+258 84 123 4567',
                        address: 'Av. Julius Nyerere, 123 - Polana, Maputo',
                        services: ['Corte Masculino', 'Barba'],
                        openingHours: { opening: '09:00', closing: '18:00' },
                        photos: [],
                        submittedAt: new Date().toISOString()
                    }
                ];

                this.state.professionals = [
                    {
                        id: 1,
                        userId: 3,
                        salonId: 1,
                        name: 'Jo√£o Silva',
                        specialty: 'Cabelereiro Profissional',
                        description: 'Especialista em cortes masculinos cl√°ssicos e contempor√¢neos',
                        services: ['Corte Masculino', 'Barba', 'Corte + Barba'],
                        rating: 4.9,
                        reviews: 128,
                        image: 'https://images.unsplash.com/photo-1562322140-8baeececf3df?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8aGFpcmRyZXNzZXJ8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=500&q=60',
                        profileImage: 'https://images.unsplash.com/photo-1562322140-8baeececf3df?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8aGFpcmRyZXNzZXJ8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=500&q=60',
                        price: '45,00 MT',
                        location: 'Maputo',
                        status: 'approved'
                    }
                ];

                this.state.appointments = [
                    {
                        id: 1,
                        professionalId: 1,
                        clientName: 'Cliente Teste',
                        service: 'Corte Masculino',
                        date: new Date().toISOString(),
                        time: '14:00',
                        price: '45,00 MT',
                        status: 'pending',
                        code: 'WC001',
                        location: 'Maputo',
                        phone: '+258 84 123 4567',
                        address: 'Av. Julius Nyerere, 123 - Polana, Maputo',
                        image: 'https://images.unsplash.com/photo-1562322140-8baeececf3df?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8aGFpcmRyZXNzZXJ8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=500&q=60'
                    }
                ];

                this.state.reviews = [];
            }

            setCurrentUser(user) {
                this.state.currentUser = user;
                this.saveState();
            }

            addUser(userData) {
                const newUser = {
                    id: Date.now(),
                    ...userData
                };
                this.state.users.push(newUser);
                this.saveState();
                return newUser;
            }

            addSalon(salonData) {
                const newSalon = {
                    id: Date.now(),
                    ...salonData,
                    photos: salonData.photos || []
                };
                this.state.salons.push(newSalon);
                this.saveState();
                return newSalon;
            }

            addProfessional(professionalData) {
                const newProfessional = {
                    id: Date.now(),
                    ...professionalData
                };
                this.state.professionals.push(newProfessional);
                this.saveState();
                return newProfessional;
            }

            addAppointment(appointmentData) {
                const newAppointment = {
                    id: Date.now(),
                    code: 'WC' + String(this.state.appointments.length + 1).padStart(3, '0'),
                    ...appointmentData
                };
                this.state.appointments.push(newAppointment);
                this.saveState();
                return newAppointment;
            }

            addReview(reviewData) {
                const newReview = {
                    id: Date.now(),
                    ...reviewData,
                    createdAt: new Date().toISOString()
                };
                this.state.reviews.push(newReview);

                // Atualizar rating do profissional
                const professionalReviews = this.state.reviews.filter(r => r.professionalId === reviewData.professionalId);
                const totalRating = professionalReviews.reduce((sum, review) => sum + review.rating, 0);
                const averageRating = professionalReviews.length > 0 ? totalRating / professionalReviews.length : 0;

                const professional = this.state.professionals.find(p => p.id === reviewData.professionalId);
                if (professional) {
                    professional.rating = parseFloat(averageRating.toFixed(1));
                    professional.reviews = professionalReviews.length;
                }

                this.saveState();
                return newReview;
            }

            getApprovedProfessionals() {
                return this.state.professionals.filter(pro => pro.status === 'approved');
            }

            getProfessionalAppointments(professionalId) {
                return this.state.appointments.filter(apt => apt.professionalId === professionalId);
            }

            getUserAppointments(userId) {
                const user = this.state.users.find(u => u.id === userId);
                if (!user) return [];
                
                if (user.type === 'client') {
                    return this.state.appointments.filter(apt => apt.clientName === user.name);
                }
                return [];
            }

            updateAppointmentStatus(appointmentId, status) {
                const appointment = this.state.appointments.find(apt => apt.id === appointmentId);
                if (appointment) {
                    appointment.status = status;
                    this.saveState();
                    return true;
                }
                return false;
            }

            removeProfessional(professionalId) {
                const index = this.state.professionals.findIndex(p => p.id === professionalId);
                if (index !== -1) {
                    this.state.professionals.splice(index, 1);
                    this.saveState();
                    return true;
                }
                return false;
            }

            setAdminTab(tab) {
                this.state.adminTab = tab;
                this.saveState();
            }

            setProfessionalTab(tab) {
                this.state.professionalTab = tab;
                this.saveState();
            }

            saveState() {
                localStorage.setItem('wecut-state', JSON.stringify(this.state));
            }

            // M√©todo para autenticar usu√°rio
            authenticateUser(email, password) {
                const user = this.state.users.find(u => u.email === email);
                console.log('Tentando autenticar:', email);
                console.log('Usu√°rio encontrado:', user);
                console.log('Senha fornecida:', password);
                console.log('Senha esperada:', user?.password);
                
                if (user && user.password === password) {
                    return user;
                }
                return null;
            }

            // Verificar se email j√° existe
            userExists(email) {
                return this.state.users.some(user => user.email === email);
            }

            // M√©todo para obter reviews de um profissional
            getProfessionalReviews(professionalId) {
                return this.state.reviews.filter(review => review.professionalId === professionalId);
            }
        }

        const stateManager = new StateManager();

        // Fun√ß√µes de Navega√ß√£o e UI
        function initNavbarListeners() {
            document.querySelectorAll('.nav-link').forEach(button => {
                button.addEventListener('click', function() {
                    const viewName = this.getAttribute('data-view');
                    renderView(viewName);
                });
            });

            document.getElementById('logo').addEventListener('click', function() {
                renderView('home-page');
            });

            document.getElementById('login-btn')?.addEventListener('click', function() {
                renderView('login-page');
            });

            document.getElementById('signup-btn')?.addEventListener('click', function() {
                renderView('login-page');
                setTimeout(() => {
                    showRegisterForm();
                }, 100);
            });

            document.getElementById('logout-btn')?.addEventListener('click', function() {
                handleLogout();
            });
        }

        function handleLogout() {
            stateManager.setCurrentUser(null);
            renderView('home-page');
            updateAuthUI();
        }

        function updateAuthUI() {
            const authButtons = document.getElementById('auth-buttons');
            const userMenu = document.getElementById('user-menu');

            if (stateManager.state.currentUser) {
                if (authButtons) authButtons.classList.add('hidden');
                if (userMenu) userMenu.classList.remove('hidden');
                
                const userName = document.getElementById('user-name');
                if (userName) userName.textContent = stateManager.state.currentUser.name;
                updateUserTypeNavigation();
            } else {
                if (authButtons) authButtons.classList.remove('hidden');
                if (userMenu) userMenu.classList.add('hidden');
            }
        }

        function updateUserTypeNavigation() {
            const clientNav = document.getElementById('client-nav');
            const professionalNav = document.getElementById('professional-nav');
            const adminNav = document.getElementById('admin-nav');

            if (clientNav) clientNav.classList.add('hidden');
            if (professionalNav) professionalNav.classList.add('hidden');
            if (adminNav) adminNav.classList.add('hidden');

            if (stateManager.state.currentUser?.type === 'client') {
                if (clientNav) clientNav.classList.remove('hidden');
            } else if (stateManager.state.currentUser?.type === 'professional') {
                if (professionalNav) professionalNav.classList.remove('hidden');
            } else if (stateManager.state.currentUser?.type === 'admin') {
                if (adminNav) adminNav.classList.remove('hidden');
            }
        }

        // Fun√ß√µes de Autentica√ß√£o
        function handleLogin(event) {
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }
            
            const email = document.getElementById('email')?.value;
            const password = document.getElementById('password')?.value;

            console.log('=== TENTATIVA DE LOGIN ===');
            console.log('Email:', email);
            console.log('Senha:', password);

            if (!email || !password) {
                alert('Por favor, preencha todos os campos');
                return;
            }

            try {
                // Usar o m√©todo authenticateUser do stateManager
                const user = stateManager.authenticateUser(email, password);
                
                console.log('Resultado da autentica√ß√£o:', user);
                
                if (user) {
                    stateManager.setCurrentUser(user);
                    
                    console.log('Tipo de usu√°rio:', user.type);
                    
                    // Redirecionamento baseado no tipo de usu√°rio
                    if (user.type === 'admin') {
                        console.log('Redirecionando para admin dashboard');
                        renderView('admin-dashboard-page');
                    } else if (user.type === 'professional') {
                        console.log('Redirecionando para professional dashboard');
                        renderView('professional-dashboard-page');
                    } else {
                        console.log('Redirecionando para search page');
                        renderView('search-page');
                    }
                    
                    updateAuthUI();
                    alert(`Login realizado com sucesso! Bem-vindo(a), ${user.name}`);
                } else {
                    console.error('Autentica√ß√£o falhou');
                    alert('E-mail ou senha incorretos');
                }
            } catch (error) {
                console.error('ERRO COMPLETO:', error);
                console.error('Stack trace:', error.stack);
                alert('Erro ao fazer login: ' + error.message);
            }
        }

        async function handleRegister(event) {
            console.log('üìù Processando cadastro...');
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }
            
            const userType = document.querySelector('input[name="userType"]:checked')?.value;
            const name = document.getElementById('register-name')?.value;
            const email = document.getElementById('register-email')?.value;
            const password = document.getElementById('register-password')?.value;

            if (!name || !email || !password) {
                alert('Por favor, preencha todos os campos obrigat√≥rios');
                return;
            }
            // Valida√ß√£o de senha
            const passwordRegex = /^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{5,20}$/;
            if (!passwordRegex.test(password)) {
                alert('A senha deve ter entre 5 e 20 caracteres e incluir pelo menos uma letra e um n√∫mero.');
                return;
            }


            // Verificar se email j√° existe
            if (stateManager.userExists(email)) {
                alert('Este e-mail j√° est√° cadastrado');
                return;
            }

            try {
                const userData = {
                    name,
                    email,
                    password,
                    type: userType
                };

                if (userType === 'professional') {
                    const salonName = document.getElementById('salon-name')?.value;
                    const salonLocation = document.getElementById('salon-location')?.value;
                    const salonPhone = document.getElementById('salon-phone')?.value;
                    const salonAddress = document.getElementById('salon-address')?.value;
                    const professionalDescription = document.getElementById('professional-description')?.value;

                    if (!salonName || !salonLocation || !salonPhone || !salonAddress || !professionalDescription) {
                        alert('Por favor, preencha todos os campos obrigat√≥rios do sal√£o');
                        return;
                    }

                    // Processar foto de perfil
                    let profilePhoto = null;
                    const profilePhotoInput = document.getElementById('professional-profile-photo');
                    if (profilePhotoInput.files && profilePhotoInput.files[0]) {
                        profilePhoto = await new Promise((resolve) => {
                            const reader = new FileReader();
                            reader.onload = (e) => resolve(e.target.result);
                            reader.readAsDataURL(profilePhotoInput.files[0]);
                        });
                    }

                    // Coletar servi√ßos selecionados (n√£o obrigat√≥rios)
                    const selectedServices = Array.from(document.querySelectorAll('.service-checkbox:checked'))
                        .map(checkbox => checkbox.value);
                    
                    // Coletar servi√ßos personalizados
                    const customServices = Array.from(document.querySelectorAll('#custom-services-list > div'))
                        .map(div => div.querySelector('input[type="hidden"]').value);
                    
                    const allServices = [...selectedServices, ...customServices];

                    // Processar fotos do sal√£o
                    const photoInput = document.getElementById('salon-photos');
                    let salonPhotos = [];
                    
                    if (photoInput.files && photoInput.files.length > 0) {
                        const files = Array.from(photoInput.files).slice(0, 5); // Limitar a 5 fotos
                        
                        // Converter fotos para Data URLs (simula√ß√£o - em produ√ß√£o enviaria para servidor)
                        for (const file of files) {
                            if (file.type.startsWith('image/')) {
                                const dataUrl = await new Promise((resolve) => {
                                    const reader = new FileReader();
                                    reader.onload = (e) => resolve(e.target.result);
                                    reader.readAsDataURL(file);
                                });
                                salonPhotos.push(dataUrl);
                            }
                        }
                    }

                    const salonData = {
                        name: salonName,
                        location: salonLocation,
                        phone: salonPhone,
                        address: salonAddress,
                        services: allServices,
                        openingHours: {
                            opening: document.getElementById('opening-time')?.value || '09:00',
                            closing: document.getElementById('closing-time')?.value || '18:00'
                        },
                        photos: salonPhotos,
                        submittedAt: new Date().toISOString()
                    };

                    const newUser = stateManager.addUser(userData);
                    const newSalon = stateManager.addSalon({
                        ...salonData,
                        userId: newUser.id
                    });
                    
                    stateManager.addProfessional({
                        userId: newUser.id,
                        salonId: newSalon.id,
                        name: userData.name,
                        specialty: allServices[0] || 'Profissional de Beleza',
                        description: professionalDescription,
                        services: allServices,
                        rating: 0,
                        reviews: 0,
                        image: salonPhotos.length > 0 ? salonPhotos[0] : 'https://images.unsplash.com/photo-1562322140-8baeececf3df?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8aGFpcmRyZXNzZXJ8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=500&q=60',
                        profileImage: profilePhoto || 'https://images.unsplash.com/photo-1562322140-8baeececf3df?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8aGFpcmRyZXNzZXJ8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=500&q=60',
                        price: '45,00 MT',
                        location: salonData.location,
                        status: 'approved'
                    });

                    stateManager.setCurrentUser(newUser);
                    
                    alert('‚úÖ Cadastro realizado com sucesso! Seu perfil profissional j√° est√° ativo.');
                    renderView('professional-dashboard-page');
                    
                } else {
                    const newUser = stateManager.addUser(userData);
                    stateManager.setCurrentUser(newUser);
                    alert('‚úÖ Cadastro realizado com sucesso!');
                    renderView('search-page');
                }

                const registerForm = document.getElementById('register-form');
                if (registerForm) registerForm.reset();
                
            } catch (error) {
                console.error('Erro no cadastro:', error);
                alert('Erro ao realizar cadastro. Tente novamente.');
            }
        }

        function showRegisterForm() {
            const loginForm = document.getElementById('login-form');
            const registerForm = document.getElementById('register-form');
            
            if (loginForm && registerForm) {
                loginForm.classList.add('hidden');
                registerForm.classList.remove('hidden');
                
                // Atualizar √≠cones ap√≥s mostrar o formul√°rio
                if (window.lucide) {
                    setTimeout(() => {
                        lucide.createIcons();
                    }, 100);
                }
            }
        }

        function showLoginForm() {
            const loginForm = document.getElementById('login-form');
            const registerForm = document.getElementById('register-form');
            
            if (loginForm && registerForm) {
                registerForm.classList.add('hidden');
                loginForm.classList.remove('hidden');
            }
        }

        // Fun√ß√µes para download de relat√≥rios
        function downloadProfessionalReport() {
            const professional = stateManager.state.professionals.find(p => p.userId === stateManager.state.currentUser?.id);
            const appointments = stateManager.getProfessionalAppointments(professional?.id);
            const completedAppointments = appointments.filter(apt => apt.status === 'completed');
            
            let csvContent = "data:text/csv;charset=utf-8,";
            csvContent += "Relat√≥rio Completo - WeCut\n\n";
            csvContent += `Profissional: ${professional.name}\n`;
            csvContent += `Data do Relat√≥rio: ${new Date().toLocaleDateString('pt-BR')}\n\n`;
            
            // Estat√≠sticas
            csvContent += "ESTAT√çSTICAS\n";
            csvContent += `Total de Servi√ßos Realizados: ${completedAppointments.length}\n`;
            csvContent += `Avalia√ß√£o M√©dia: ${professional.rating} ‚≠ê\n`;
            csvContent += `Total de Avalia√ß√µes: ${professional.reviews}\n\n`;
            
            // Servi√ßos realizados
            csvContent += "SERVI√áOS REALIZADOS\n";
            csvContent += "Data,Cliente,Servi√ßo,Valor,Status\n";
            
            completedAppointments.forEach(apt => {
                csvContent += `${new Date(apt.date).toLocaleDateString('pt-BR')},${apt.clientName},${apt.service},${apt.price},${apt.status}\n`;
            });
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", `relatorio_wecut_${professional.name}_${new Date().toISOString().split('T')[0]}.csv`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            alert('üìä Relat√≥rio baixado com sucesso!');
        }

        function downloadAdminReport() {
            const professionals = stateManager.getApprovedProfessionals();
            const appointments = stateManager.state.appointments;
            
            let csvContent = "data:text/csv;charset=utf-8,";
            csvContent += "Relat√≥rio Administrativo - WeCut\n\n";
            csvContent += `Data do Relat√≥rio: ${new Date().toLocaleDateString('pt-BR')}\n`;
            csvContent += `Total de Profissionais: ${professionals.length}\n`;
            csvContent += `Total de Agendamentos: ${appointments.length}\n\n`;
            
            // Profissionais
            csvContent += "PROFISSIONAIS CADASTRADOS\n";
            csvContent += "Nome,Especialidade,Avalia√ß√£o,Total Avalia√ß√µes,Localiza√ß√£o\n";
            
            professionals.forEach(pro => {
                csvContent += `${pro.name},${pro.specialty},${pro.rating},${pro.reviews},${pro.location}\n`;
            });
            
            csvContent += "\nAGENDAMENTOS\n";
            csvContent += "C√≥digo,Cliente,Profissional,Servi√ßo,Data,Status,Valor\n";
            
            appointments.forEach(apt => {
                const professional = stateManager.state.professionals.find(p => p.id === apt.professionalId);
                csvContent += `${apt.code},${apt.clientName},${professional?.name || 'N/A'},${apt.service},${new Date(apt.date).toLocaleDateString('pt-BR')},${apt.status},${apt.price}\n`;
            });
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", `relatorio_admin_wecut_${new Date().toISOString().split('T')[0]}.csv`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            alert('üìä Relat√≥rio administrativo baixado com sucesso!');
        }

        // Fun√ß√£o para validar data de agendamento
        function validateBookingDate(date) {
            const selectedDate = new Date(date);
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            const maxDate = new Date();
            maxDate.setDate(today.getDate() + 10);
            
            if (selectedDate < today) {
                alert('‚ùå N√£o √© poss√≠vel agendar para datas passadas.');
                return false;
            }
            
            if (selectedDate > maxDate) {
                alert('‚ùå N√£o √© poss√≠vel agendar com mais de 10 dias de anteced√™ncia.');
                return false;
            }
            
            return true;
        }

        // Views
        function getHomePageContent() {
            const professionals = stateManager.getApprovedProfessionals();
            
            return `
                <div class="min-h-screen bg-white">
                    <!-- Hero Section -->
                    <section class="bg-white py-20">
                        <div class="max-w-7xl mx-auto px-4 text-center">
                            <h1 class="text-4xl md:text-5xl lg:text-6xl font-bold text-black mb-6">
                                Encontre o sal√£o perfeito<br>para o seu estilo
                            </h1>
                            
                            <p class="text-xl text-gray-600 mb-8 max-w-2xl mx-auto">
                                Descubra os melhores profissionais de beleza perto de voc√™.<br>
                                Agende seu pr√≥ximo corte com facilidade e seguran√ßa.
                            </p>
                            
                            <!-- Search Bar -->
                            <div class="max-w-4xl mx-auto mb-8">
                                <div class="bg-white rounded-2xl shadow-lg border border-gray-200 p-6">
                                    <div class="flex flex-col md:flex-row gap-4">
                                        <div class="flex-1 relative">
                                            <i data-lucide="search" class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"></i>
                                            <input 
                                                type="text"
                                                placeholder="Pesquisar sal√£o ou profissional..."
                                                class="w-full pl-10 h-12 border border-gray-300 rounded-lg focus:border-black focus:ring-0"
                                                id="home-search-input"
                                            />
                                        </div>
                                        <button onclick="performHomeSearch()" 
                                                class="bg-black text-white hover:bg-gray-800 h-12 px-8 rounded-lg wecut-button-hover font-medium">
                                            Buscar
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Quick Actions -->
                            <div class="flex flex-wrap justify-center gap-3 mb-12">
                                <button class="px-4 py-2 text-sm border border-gray-300 rounded-full hover:bg-gray-50 cursor-pointer transition-colors">
                                    üíá Corte Masculino
                                </button>
                                <button class="px-4 py-2 text-sm border border-gray-300 rounded-full hover:bg-gray-50 cursor-pointer transition-colors">
                                    üíá‚Äç‚ôÄÔ∏è Corte Feminino
                                </button>
                                <button class="px-4 py-2 text-sm border border-gray-300 rounded-full hover:bg-gray-50 cursor-pointer transition-colors">
                                    üé® Colora√ß√£o
                                </button>
                                <button class="px-4 py-2 text-sm border border-gray-300 rounded-full hover:bg-gray-50 cursor-pointer transition-colors">
                                    üßî Barba
                                </button>
                                <button class="px-4 py-2 text-sm border border-gray-300 rounded-full hover:bg-gray-50 cursor-pointer transition-colors">
                                    üëë Tran√ßas
                                </button>
                            </div>
                        </div>
                    </section>

                    <!-- Stats Section -->
                    <section class="py-16 bg-gray-50">
                        <div class="max-w-7xl mx-auto px-4">
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-8 text-center">
                                <div>
                                    <div class="text-3xl font-bold text-black mb-2">500+</div>
                                    <div class="text-gray-600">Profissionais</div>
                                </div>
                                <div>
                                    <div class="text-3xl font-bold text-black mb-2">10.000+</div>
                                    <div class="text-gray-600">Clientes Satisfeitos</div>
                                </div>
                                <div>
                                    <div class="text-3xl font-bold text-black mb-2">15+</div>
                                    <div class="text-gray-600">Cidades</div>
                                </div>
                                <div>
                                    <div class="text-3xl font-bold text-black mb-2">4.8‚òÖ</div>
                                    <div class="text-gray-600">Avalia√ß√£o M√©dia</div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Featured Professionals -->
                    <section class="py-16 bg-white">
                        <div class="max-w-7xl mx-auto px-4">
                            <div class="text-center mb-12">
                                <h2 class="text-3xl font-bold text-black mb-4">Profissionais em Destaque</h2>
                                <p class="text-gray-600 text-lg">Os melhores cabeleireiros avaliados em Mo√ßambique</p>
                            </div>

                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                                ${professionals.slice(0, 3).map(professional => `
                                    <div class="border border-gray-300 rounded-xl hover:shadow-xl transition-all duration-300 cursor-pointer overflow-hidden group">
                                        <div class="aspect-[4/3] relative overflow-hidden">
                                            <img 
                                                src="${professional.profileImage}" 
                                                alt="${professional.name}"
                                                class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
                                            />
                                            <div class="absolute top-4 right-4">
                                                <span class="bg-white text-black border border-gray-300 px-3 py-1 rounded-full text-sm font-medium shadow-sm">
                                                    ${professional.price}
                                                </span>
                                            </div>
                                            <div class="absolute bottom-4 left-4">
                                                <span class="bg-green-600 text-white px-2 py-1 rounded text-xs font-medium">
                                                    Dispon√≠vel
                                                </span>
                                            </div>
                                        </div>
                                        
                                        <div class="p-6">
                                            <h3 class="text-xl font-semibold text-black mb-2">${professional.name}</h3>
                                            <p class="text-gray-600 mb-3">${professional.specialty}</p>
                                            
                                            <div class="flex items-center gap-4 mb-4 text-sm text-gray-600">
                                                <div class="flex items-center gap-1">
                                                    <i data-lucide="star" class="w-4 h-4 fill-yellow-400 stroke-yellow-400"></i>
                                                    <span class="font-medium text-black">${professional.rating}</span>
                                                    <span>(${professional.reviews} avalia√ß√µes)</span>
                                                </div>
                                                <div class="flex items-center gap-1">
                                                    <i data-lucide="map-pin" class="w-4 h-4"></i>
                                                    <span>${professional.location}</span>
                                                </div>
                                            </div>

                                            <div class="flex gap-2">
                                                <button 
                                                    class="flex-1 border border-gray-300 hover:bg-gray-50 py-2 rounded-lg wecut-button-hover transition-colors"
                                                    onclick="viewProfessional(${professional.id})"
                                                >
                                                    Ver Perfil
                                                </button>
                                                <button 
                                                    class="flex-1 bg-black text-white hover:bg-gray-800 py-2 rounded-lg wecut-button-hover transition-colors"
                                                    onclick="startBooking(${professional.id})"
                                                >
                                                    Agendar
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>

                            <div class="text-center mt-12">
                                <button onclick="renderView('search-page')" 
                                        class="bg-black text-white px-8 py-3 rounded-lg hover:bg-gray-800 transition-colors wecut-button-hover font-medium">
                                    Ver Todos os Profissionais
                                </button>
                            </div>
                        </div>
                    </section>

                    <!-- How it Works -->
                    <section class="py-16 bg-gray-50">
                        <div class="max-w-7xl mx-auto px-4">
                            <div class="text-center mb-12">
                                <h2 class="text-3xl font-bold text-black mb-4">Como Funciona</h2>
                                <p class="text-gray-600 text-lg">Simples, r√°pido e seguro</p>
                            </div>

                            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                                <div class="text-center p-6">
                                    <div class="w-20 h-20 bg-black rounded-full flex items-center justify-center mx-auto mb-6">
                                        <i data-lucide="search" class="w-8 h-8 text-white"></i>
                                    </div>
                                    <h3 class="text-xl font-semibold text-black mb-3">1. Busque</h3>
                                    <p class="text-gray-600">Encontre cabeleireiros no seu bairro ou cidade usando nossos filtros inteligentes e avalia√ß√µes reais</p>
                                </div>

                                <div class="text-center p-6">
                                    <div class="w-20 h-20 bg-black rounded-full flex items-center justify-center mx-auto mb-6">
                                        <i data-lucide="calendar" class="w-8 h-8 text-white"></i>
                                    </div>
                                    <h3 class="text-xl font-semibold text-black mb-3">2. Agende</h3>
                                    <p class="text-gray-600">Escolha o hor√°rio dispon√≠vel que melhor se encaixa na sua agenda com apenas alguns cliques</p>
                                </div>

                                <div class="text-center p-6">
                                    <div class="w-20 h-20 bg-black rounded-full flex items-center justify-center mx-auto mb-6">
                                        <i data-lucide="scissors" class="w-8 h-8 text-white"></i>
                                    </div>
                                    <h3 class="text-xl font-semibold text-black mb-3">3. Aproveite</h3>
                                    <p class="text-gray-600">Tenha o corte perfeito sem preocupa√ß√µes e avalie sua experi√™ncia para ajudar outros clientes</p>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Cities Section -->
                    <section class="py-16 bg-white">
                        <div class="max-w-7xl mx-auto px-4">
                            <div class="text-center mb-12">
                                <h2 class="text-3xl font-bold text-black mb-4">Dispon√≠vel nas Principais Cidades</h2>
                                <p class="text-gray-600 text-lg">Encontre profissionais de qualidade em todo Mo√ßambique</p>
                            </div>

                            <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
                                ${['Maputo', 'Matola', 'Beira', 'Nampula', 'Quelimane', 'Tete', 'Xai-Xai', 'Inhambane', 'Lichinga', 'Pemba', 'Chimoio', 'Nacala'].map(city => `
                                    <div class="text-center p-4 border border-gray-200 rounded-lg hover:border-black transition-colors cursor-pointer">
                                        <i data-lucide="map-pin" class="w-6 h-6 text-red-500 mx-auto mb-2"></i>
                                        <span class="text-black font-medium">${city}</span>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </section>

                    <!-- CTA Section -->
                    <section class="py-20 bg-black">
                        <div class="max-w-4xl mx-auto px-4 text-center">
                            <h2 class="text-3xl md:text-4xl font-bold text-white mb-4">
                                Pronto para o seu pr√≥ximo corte?
                            </h2>
                            <p class="text-gray-300 text-lg mb-8">
                                Junte-se a milhares de clientes satisfeitos e descubra os melhores profissionais de beleza perto de voc√™.
                            </p>
                            <div class="flex flex-col sm:flex-row gap-4 justify-center">
                                <button onclick="renderView('search-page')" 
                                        class="bg-white text-black px-8 py-3 rounded-lg hover:bg-gray-100 transition-colors wecut-button-hover font-medium">
                                    Encontrar Profissionais
                                </button>
                                ${!stateManager.state.currentUser ? `
                                    <button onclick="renderView('login-page')" 
                                            class="border border-white text-white px-8 py-3 rounded-lg hover:bg-white hover:text-black transition-colors wecut-button-hover font-medium">
                                        Criar Conta
                                    </button>
                                ` : ''}
                            </div>
                        </div>
                    </section>
                </div>
            `;
        }

        function getSearchPageContent() {
            const professionals = stateManager.getApprovedProfessionals();
            
            return `
                <div class="min-h-screen bg-gray-50">
                    <div class="max-w-7xl mx-auto px-4 py-8">
                        <!-- Search Header -->
                        <div class="bg-white rounded-lg p-6 mb-8 border border-gray-300">
                            <div class="flex flex-col md:flex-row gap-4">
                                <div class="flex-1 relative">
                                    <i data-lucide="search" class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"></i>
                                    <input 
                                        type="text"
                                        placeholder="Buscar por localiza√ß√£o, servi√ßo ou profissional..."
                                        class="w-full pl-10 h-12 border border-gray-300 rounded-lg focus:border-black focus:ring-0"
                                        id="search-input"
                                    />
                                </div>
                                <button class="border border-gray-300 h-12 px-6 rounded-lg hover:bg-gray-50 wecut-button-hover" onclick="showFilters()">
                                    <i data-lucide="filter" class="w-4 h-4 inline mr-2"></i>
                                    Filtros
                                </button>
                                <button class="bg-black text-white hover:bg-gray-800 h-12 px-8 rounded-lg wecut-button-hover" onclick="performSearch()">
                                    Buscar
                                </button>
                            </div>
                        </div>

                        <!-- Results Header -->
                        <div class="flex items-center justify-between mb-6">
                            <h2 class="text-2xl text-black" id="results-count">${professionals.length} profissionais encontrados</h2>
                            <select class="w-48 border border-gray-300 rounded-lg p-2 focus:border-black focus:ring-0" id="sort-select">
                                <option>Ordenar por relev√¢ncia</option>
                                <option>Melhor avaliado</option>
                                <option>Mais pr√≥ximo</option>
                                <option>Menor pre√ßo</option>
                                <option>Maior pre√ßo</option>
                            </select>
                        </div>

                        <!-- Results Grid -->
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6" id="search-results">
                            ${professionals.map(professional => `
                                <div class="border border-gray-300 cursor-pointer transition-all hover:shadow-lg rounded-lg overflow-hidden">
                                    <div class="flex">
                                        <div class="w-32 h-32 relative flex-shrink-0">
                                            <img 
                                                src="${professional.profileImage}" 
                                                alt="${professional.name}"
                                                class="w-full h-full object-cover"
                                            />
                                            <div class="absolute top-2 left-2">
                                                <span class="bg-green-600 text-white text-xs px-2 py-1 rounded">Dispon√≠vel</span>
                                            </div>
                                        </div>
                                        
                                        <div class="flex-1 p-4">
                                            <div class="flex items-start justify-between mb-2">
                                                <div>
                                                    <h3 class="text-lg text-black">${professional.name}</h3>
                                                    <p class="text-gray-600 text-sm">${professional.specialty}</p>
                                                </div>
                                                <div class="text-right">
                                                    <p class="text-lg text-black">${professional.price}</p>
                                                    <p class="text-xs text-gray-500">por servi√ßo</p>
                                                </div>
                                            </div>
                                            
                                            <div class="flex items-center gap-4 mb-3 text-sm text-gray-600">
                                                <div class="flex items-center gap-1">
                                                    <i data-lucide="star" class="w-4 h-4 fill-yellow-400 stroke-yellow-400"></i>
                                                    <span>${professional.rating}</span>
                                                    <span>(${professional.reviews})</span>
                                                </div>
                                                <div class="flex items-center gap-1">
                                                    <i data-lucide="map-pin" class="w-4 h-4"></i>
                                                    <span>${professional.location}</span>
                                                </div>
                                                <div class="flex items-center gap-1">
                                                    <i data-lucide="clock" class="w-4 h-4"></i>
                                                    <span>Hoje, 14:30</span>
                                                </div>
                                            </div>

                                            <div class="flex gap-2">
                                                <button 
                                                    class="flex-1 border border-gray-300 hover:bg-gray-50 py-2 rounded wecut-button-hover"
                                                    onclick="viewProfessional(${professional.id})"
                                                >
                                                    Ver Perfil
                                                </button>
                                                <button 
                                                    class="flex-1 bg-black text-white hover:bg-gray-800 py-2 rounded wecut-button-hover"
                                                    onclick="startBooking(${professional.id})"
                                                >
                                                    Agendar
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
        }

        function getLoginPageContent() {
            return `
                <div class="min-h-screen bg-white flex items-center justify-center px-4 py-8">
                    <div class="w-full max-w-md">
                        <!-- Back Button -->
                        <button class="mb-8 text-black hover:bg-gray-50 p-2 rounded wecut-button-hover"
                                onclick="renderView('home-page')">
                            <i data-lucide="arrow-left" class="w-4 h-4 inline mr-2"></i>
                            Voltar
                        </button>

                        <!-- Logo -->
                        <div class="text-center mb-8">
                            <h1 class="text-3xl font-medium text-black mb-2">WeCut</h1>
                            <p class="text-gray-600">Entre na sua conta</p>
                        </div>

                        <!-- Login Form -->
                        <div class="border border-gray-300 rounded-lg wecut-shadow p-6">
                            <h2 class="text-2xl text-center text-black mb-6">Fazer Login</h2>
                            
                            <form id="login-form" class="space-y-6">
                                <div>
                                    <label for="email" class="block text-black mb-2">E-mail</label>
                                    <input type="email" id="email" required
                                           class="w-full p-3 border border-gray-300 rounded-lg focus:border-black focus:ring-0"
                                           placeholder="seu@email.com">
                                </div>
                                
                                <div>
                                    <label for="password" class="block text-black mb-2">Senha</label>
                                    <input type="password" id="password" required
                                           class="w-full p-3 border border-gray-300 rounded-lg focus:border-black focus:ring-0"
                                           placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                                </div>

                                <button type="button" onclick="handleLogin()" 
                                        class="w-full bg-black text-white hover:bg-gray-800 py-3 rounded-lg wecut-button-hover">
                                    Entrar
                                </button>

                                <div class="text-center">
                                    <span class="text-gray-600">N√£o tem uma conta? </span>
                                    <button type="button" class="text-black hover:text-gray-600" 
                                            onclick="showRegisterForm()">
                                        Criar conta
                                    </button>
                                </div>
                            </form>

                            <!-- Registration Form -->
                            <div id="register-form" class="hidden space-y-6 mt-6">
                                <div>
                                    <label class="block text-black mb-3">Tipo de conta</label>
                                    <div class="grid grid-cols-2 gap-4">
                                        <label class="flex items-center p-4 border border-gray-300 rounded-lg hover:bg-gray-50 cursor-pointer">
                                            <input type="radio" name="userType" value="client" class="mr-3" checked>
                                            <div>
                                                <p class="font-medium text-black">Cliente</p>
                                                <p class="text-sm text-gray-600">Agendar servi√ßos</p>
                                            </div>
                                        </label>
                                        <label class="flex items-center p-4 border border-gray-300 rounded-lg hover:bg-gray-50 cursor-pointer">
                                            <input type="radio" name="userType" value="professional" class="mr-3">
                                            <div>
                                                <p class="font-medium text-black">Profissional</p>
                                                <p class="text-sm text-gray-600">Oferecer servi√ßos</p>
                                            </div>
                                        </label>
                                    </div>
                                </div>

                                <input type="text" id="register-name" placeholder="Nome completo" 
                                       class="w-full p-3 border border-gray-300 rounded-lg focus:border-black focus:ring-0" required>
                                <input type="email" id="register-email" placeholder="E-mail" 
                                       class="w-full p-3 border border-gray-300 rounded-lg focus:border-black focus:ring-0" required>
                                <input type="password" id="register-password" placeholder="Senha" 
                                       class="w-full p-3 border border-gray-300 rounded-lg focus:border-black focus:ring-0" required>

                                <!-- Professional fields -->
                                <div id="professional-fields" class="hidden space-y-4">
                                    <!-- Foto de Perfil -->
                                    <div>
                                        <label class="block text-sm font-medium text-black mb-2">Foto de Perfil</label>
                                        <input type="file" id="professional-profile-photo" accept="image/*" class="w-full p-3 border border-gray-300 rounded-lg focus:border-black focus:ring-0">
                                        <p class="text-xs text-gray-500 mt-1">Esta foto ser√° exibida na busca e no perfil</p>
                                        <div id="profile-photo-preview" class="mt-2"></div>
                                    </div>

                                    <input type="text" id="salon-name" placeholder="Nome do sal√£o/estabelecimento" 
                                           class="w-full p-3 border border-gray-300 rounded-lg focus:border-black focus:ring-0">
                                    <input type="text" id="salon-location" placeholder="Localiza√ß√£o (cidade, bairro)" 
                                           class="w-full p-3 border border-gray-300 rounded-lg focus:border-black focus:ring-0">
                                    <input type="tel" id="salon-phone" placeholder="Telefone do sal√£o" 
                                           class="w-full p-3 border border-gray-300 rounded-lg focus:border-black focus:ring-0">
                                    <textarea id="salon-address" placeholder="Endere√ßo completo do sal√£o" 
                                              class="w-full p-3 border border-gray-300 rounded-lg focus:border-black focus:ring-0"></textarea>
                                    
                                    <!-- Descri√ß√£o do profissional -->
                                    <div>
                                        <label class="block text-sm font-medium text-black mb-2">Descri√ß√£o do Profissional</label>
                                        <textarea id="professional-description" rows="3" 
                                                  class="w-full p-3 border border-gray-300 rounded-lg focus:border-black focus:ring-0"
                                                  placeholder="Descreva seus servi√ßos, experi√™ncia, etc." required></textarea>
                                    </div>
                                    
                                    <!-- Servi√ßos oferecidos - N√ÉO OBRIGAT√ìRIOS -->
                                    <div>
                                        <label class="block text-sm font-medium text-black mb-2">Servi√ßos Oferecidos (opcional)</label>
                                        <div class="grid grid-cols-2 gap-2 mb-3">
                                            <label class="flex items-center">
                                                <input type="checkbox" value="Corte Masculino" class="mr-2 service-checkbox">
                                                <span class="text-sm">Corte Masculino</span>
                                            </label>
                                            <label class="flex items-center">
                                                <input type="checkbox" value="Corte Feminino" class="mr-2 service-checkbox">
                                                <span class="text-sm">Corte Feminino</span>
                                            </label>
                                            <label class="flex items-center">
                                                <input type="checkbox" value="Barba" class="mr-2 service-checkbox">
                                                <span class="text-sm">Barba</span>
                                            </label>
                                            <label class="flex items-center">
                                                <input type="checkbox" value="Colora√ß√£o" class="mr-2 service-checkbox">
                                                <span class="text-sm">Colora√ß√£o</span>
                                            </label>
                                            <label class="flex items-center">
                                                <input type="checkbox" value="Manicure" class="mr-2 service-checkbox">
                                                <span class="text-sm">Manicure</span>
                                            </label>
                                            <label class="flex items-center">
                                                <input type="checkbox" value="Pedicure" class="mr-2 service-checkbox">
                                                <span class="text-sm">Pedicure</span>
                                            </label>
                                        </div>
                                        
                                        <!-- Campo para servi√ßo personalizado -->
                                        <div class="flex gap-2">
                                            <input type="text" id="custom-service" placeholder="Adicionar servi√ßo personalizado" 
                                                   class="flex-1 p-2 border border-gray-300 rounded-lg focus:border-black focus:ring-0">
                                            <button type="button" onclick="addCustomService()" 
                                                    class="bg-black text-white px-4 py-2 rounded-lg hover:bg-gray-800 wecut-button-hover">
                                                Adicionar
                                            </button>
                                        </div>
                                        <div id="custom-services-list" class="flex flex-wrap gap-2 mt-2"></div>
                                    </div>
                                    
                                    <!-- Hor√°rio de funcionamento -->
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-black mb-2">Hor√°rio de Abertura</label>
                                            <input type="time" id="opening-time" 
                                                   class="w-full p-3 border border-gray-300 rounded-lg focus:border-black focus:ring-0"
                                                   value="09:00">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-black mb-2">Hor√°rio de Fechamento</label>
                                            <input type="time" id="closing-time" 
                                                   class="w-full p-3 border border-gray-300 rounded-lg focus:border-black focus:ring-0"
                                                   value="18:00">
                                        </div>
                                    </div>
                                    
                                    <!-- Upload de fotos via input file -->
                                    <div>
                                        <label class="block text-sm font-medium text-black mb-2">Fotos do Sal√£o (Galeria)</label>
                                        <input type="file" id="salon-photos" multiple accept="image/*" 
                                               class="w-full p-3 border border-gray-300 rounded-lg focus:border-black focus:ring-0">
                                        <p class="text-xs text-gray-500 mt-1">Selecione as fotos do seu sal√£o para a galeria (m√°x. 5 fotos)</p>
                                        <div id="photo-preview" class="grid grid-cols-2 gap-2 mt-3"></div>
                                    </div>
                                </div>

                                <button type="button" onclick="handleRegister()" 
                                        class="w-full bg-green-600 text-white hover:bg-green-700 py-3 rounded-lg wecut-button-hover">
                                    Cadastrar
                                </button>

                                <div class="text-center">
                                    <button type="button" onclick="showLoginForm()" 
                                            class="text-black hover:text-gray-600">
                                        J√° tem conta? Fazer login
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- AVISO DE SEGURAN√áA -->
                        <div class="mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded text-sm text-yellow-800">
                            <strong>‚ö†Ô∏è AVISO:</strong> Esta √© uma demonstra√ß√£o frontend. 
                            Em produ√ß√£o, a autentica√ß√£o deve ser implementada no backend com medidas de seguran√ßa adequadas.
                        </div>
                    </div>
                </div>
            `;
        }

        function getProfessionalProfileContent() {
            const professional = stateManager.state.professionals.find(p => p.id === stateManager.state.bookingProfessionalId) || stateManager.state.professionals[0];
            const salon = stateManager.state.salons.find(s => s.id === professional.salonId);
            const reviews = stateManager.getProfessionalReviews(professional.id);
            
            return `
                <div class="min-h-screen bg-white">
                    <div class="max-w-6xl mx-auto">
                        <!-- Header -->
                        <div class="flex items-center justify-between p-4 border-b border-gray-300">
                            <button 
                                class="text-black hover:bg-gray-50 p-2 rounded wecut-button-hover"
                                onclick="renderView('search-page')"
                            >
                                <i data-lucide="arrow-left" class="w-4 h-4 inline mr-2"></i>
                                Voltar
                            </button>
                            <div class="flex gap-2">
                                <button class="text-black hover:bg-gray-50 p-2 rounded wecut-button-hover">
                                    <i data-lucide="heart" class="w-4 h-4"></i>
                                </button>
                                <button class="text-black hover:bg-gray-50 p-2 rounded wecut-button-hover">
                                    <i data-lucide="share-2" class="w-4 h-4"></i>
                                </button>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 p-6">
                            <!-- Left Column - Profile Info -->
                            <div class="lg:col-span-2 space-y-6">
                                <!-- Professional Header -->
                                <div class="flex items-start gap-6">
                                    <div class="w-24 h-24 rounded-full overflow-hidden flex-shrink-0">
                                        <img 
                                            src="${professional.profileImage}" 
                                            alt="${professional.name}"
                                            class="w-full h-full object-cover"
                                        />
                                    </div>
                                    <div class="flex-1">
                                        <h1 class="text-3xl font-medium text-black mb-1">${professional.name}</h1>
                                        <p class="text-lg text-gray-600 mb-2">${salon?.name || 'Sal√£o'}</p>
                                        <p class="text-gray-600 mb-3">${professional.specialty}</p>
                                        
                                        <div class="flex items-center gap-6 mb-4">
                                            <div class="flex items-center gap-2">
                                                <div class="flex gap-1">
                                                    ${Array(5).fill().map((_, i) => `
                                                        <i data-lucide="star" class="w-4 h-4 ${i < Math.floor(professional.rating) ? 'fill-yellow-400 stroke-yellow-400' : 'stroke-gray-300'}"></i>
                                                    `).join('')}
                                                </div>
                                                <span class="text-lg font-medium text-black">${professional.rating}</span>
                                                <span class="text-gray-600">(${professional.reviews} avalia√ß√µes)</span>
                                            </div>
                                            <div class="flex items-center gap-1 text-gray-600">
                                                <i data-lucide="map-pin" class="w-4 h-4"></i>
                                                <span>${professional.location}</span>
                                            </div>
                                        </div>

                                        <p class="text-gray-700 mb-4">${professional.description}</p>

                                        <div class="flex items-center gap-4 text-sm text-gray-600">
                                            <div class="flex items-center gap-1">
                                                <i data-lucide="clock" class="w-4 h-4"></i>
                                                <span>${salon?.openingHours?.opening || '09:00'} - ${salon?.openingHours?.closing || '18:00'}</span>
                                            </div>
                                            <div class="flex items-center gap-1">
                                                <i data-lucide="phone" class="w-4 h-4"></i>
                                                <span>${salon?.phone || 'N/A'}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Tabs Content -->
                                <div class="border border-gray-300 rounded-lg">
                                    <div class="border-b border-gray-300">
                                        <div class="flex">
                                            <button class="flex-1 py-4 text-center border-b-2 border-black text-black font-medium" onclick="switchProfileTab('portfolio')">Portf√≥lio</button>
                                            <button class="flex-1 py-4 text-center text-gray-600 hover:text-black" onclick="switchProfileTab('services')">Servi√ßos</button>
                                            <button class="flex-1 py-4 text-center text-gray-600 hover:text-black" onclick="switchProfileTab('reviews')">Avalia√ß√µes</button>
                                        </div>
                                    </div>
                                    
                                    <div class="p-6">
                                        <!-- Portfolio Content -->
                                        <div id="portfolio-content" class="space-y-6">
                                            ${salon?.photos && salon.photos.length > 0 ? `
                                                <div class="aspect-[4/3] rounded-lg overflow-hidden">
                                                    <img 
                                                        src="${salon.photos[0]}" 
                                                        alt="Portfolio image"
                                                        class="w-full h-full object-cover"
                                                    />
                                                </div>
                                                
                                                <div class="grid grid-cols-4 gap-4">
                                                    ${salon.photos.slice(0, 4).map(photo => `
                                                        <div class="aspect-square rounded-lg overflow-hidden border-2 border-gray-300">
                                                            <img 
                                                                src="${photo}" 
                                                                alt="Thumbnail"
                                                                class="w-full h-full object-cover"
                                                            />
                                                        </div>
                                                    `).join('')}
                                                </div>
                                            ` : `
                                                <div class="text-center py-8">
                                                    <i data-lucide="camera" class="w-12 h-12 text-gray-400 mx-auto mb-4"></i>
                                                    <p class="text-gray-600">Nenhuma foto dispon√≠vel</p>
                                                </div>
                                            `}
                                        </div>

                                        <!-- Services Content -->
                                        <div id="services-content" class="hidden space-y-4">
                                            ${professional.services.map(service => `
                                                <div class="flex justify-between items-center p-4 border border-gray-300 rounded-lg">
                                                    <div>
                                                        <h4 class="font-medium text-black">${service}</h4>
                                                        <p class="text-sm text-gray-600">Servi√ßo profissional de qualidade</p>
                                                    </div>
                                                    <span class="text-black font-medium">${professional.price}</span>
                                                </div>
                                            `).join('')}
                                        </div>

                                        <!-- Reviews Content -->
                                        <div id="reviews-content" class="hidden space-y-6">
                                            ${reviews.length > 0 ? reviews.map(review => `
                                                <div class="border-b border-gray-200 pb-4">
                                                    <div class="flex items-center gap-2 mb-2">
                                                        <div class="flex gap-1">
                                                            ${Array(5).fill().map((_, i) => `
                                                                <i data-lucide="star" class="w-4 h-4 ${i < review.rating ? 'fill-yellow-400 stroke-yellow-400' : 'stroke-gray-300'}"></i>
                                                            `).join('')}
                                                        </div>
                                                        <span class="font-medium text-black">${review.clientName}</span>
                                                        <span class="text-sm text-gray-500">${new Date(review.createdAt).toLocaleDateString('pt-BR')}</span>
                                                    </div>
                                                    ${review.comment ? `<p class="text-gray-700">${review.comment}</p>` : ''}
                                                </div>
                                            `).join('') : `
                                                <div class="text-center py-8">
                                                    <i data-lucide="star" class="w-12 h-12 text-gray-400 mx-auto mb-4"></i>
                                                    <p class="text-gray-600">Nenhuma avalia√ß√£o dispon√≠vel</p>
                                                </div>
                                            `}
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Right Column - Booking -->
                            <div class="space-y-6">
                                <!-- Quick Book Card -->
                                <div class="border border-gray-300 rounded-lg wecut-shadow p-6 sticky top-6">
                                    <h3 class="text-xl font-medium text-black mb-4">Agendar Hor√°rio</h3>
                                    
                                    <div class="space-y-4 mb-6">
                                        <div>
                                            <p class="text-sm font-medium text-black mb-2">Pr√≥ximos hor√°rios</p>
                                            <div class="space-y-2">
                                                ${['Hoje, 14:30', 'Hoje, 15:00', 'Amanh√£, 09:00'].map(slot => `
                                                    <button class="w-full p-3 text-left border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
                                                        <div class="flex justify-between items-center">
                                                            <span class="text-black">${slot.split(', ')[0]}</span>
                                                            <span class="text-gray-600">${slot.split(', ')[1]}</span>
                                                        </div>
                                                    </button>
                                                `).join('')}
                                            </div>
                                        </div>
                                    </div>

                                    <div class="space-y-3">
                                        <button 
                                            class="w-full bg-black text-white hover:bg-gray-800 py-2 rounded wecut-button-hover"
                                            onclick="startBooking(${professional.id})"
                                        >
                                            <i data-lucide="calendar" class="w-4 h-4 inline mr-2"></i>
                                            Agendar agora
                                        </button>
                                        
                                        <button class="w-full border border-gray-300 hover:bg-gray-50 py-2 rounded wecut-button-hover">
                                            <i data-lucide="phone" class="w-4 h-4 inline mr-2"></i>
                                            Ligar
                                        </button>
                                    </div>

                                    <div class="mt-6 pt-6 border-t border-gray-300">
                                        <div class="text-center text-sm text-gray-600">
                                            <p class="mb-1">üìç ${salon?.address || 'Endere√ßo n√£o dispon√≠vel'}</p>
                                            <button class="text-black hover:text-gray-600">Ver no mapa</button>
                                        </div>
                                    </div>
                                </div>

                                <!-- Business Hours -->
                                <div class="border border-gray-300 rounded-lg p-6">
                                    <h4 class="font-medium text-black mb-4">Hor√°rio de Funcionamento</h4>
                                    <div class="space-y-2 text-sm">
                                        ${[
                                            ['Segunda-feira', `${salon?.openingHours?.opening || '09:00'} - ${salon?.openingHours?.closing || '18:00'}`],
                                            ['Ter√ßa-feira', `${salon?.openingHours?.opening || '09:00'} - ${salon?.openingHours?.closing || '18:00'}`],
                                            ['Quarta-feira', `${salon?.openingHours?.opening || '09:00'} - ${salon?.openingHours?.closing || '18:00'}`],
                                            ['Quinta-feira', `${salon?.openingHours?.opening || '09:00'} - ${salon?.openingHours?.closing || '18:00'}`],
                                            ['Sexta-feira', `${salon?.openingHours?.opening || '09:00'} - ${salon?.openingHours?.closing || '18:00'}`],
                                            ['S√°bado', `${salon?.openingHours?.opening || '09:00'} - ${salon?.openingHours?.closing || '18:00'}`],
                                            ['Domingo', 'Fechado']
                                        ].map(([day, hours]) => `
                                            <div class="flex justify-between">
                                                <span class="text-gray-600">${day}</span>
                                                <span class="${day === 'Domingo' ? 'text-red-600' : 'text-black'}">${hours}</span>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function switchProfileTab(tab) {
            // Esconder todos os conte√∫dos
            document.getElementById('portfolio-content').classList.add('hidden');
            document.getElementById('services-content').classList.add('hidden');
            document.getElementById('reviews-content').classList.add('hidden');
            
            // Mostrar conte√∫do selecionado
            document.getElementById(tab + '-content').classList.remove('hidden');
            
            // Atualizar tabs ativas
            document.querySelectorAll('.border-b-2').forEach(tab => {
                tab.classList.remove('border-black', 'text-black', 'font-medium');
                tab.classList.add('text-gray-600');
            });
            
            event.target.classList.add('border-black', 'text-black', 'font-medium');
            event.target.classList.remove('text-gray-600');
        }

        function getBookingPageContent() {
            const professional = stateManager.state.professionals.find(p => p.id === stateManager.state.bookingProfessionalId) || stateManager.state.professionals[0];
            const salon = stateManager.state.salons.find(s => s.id === professional.salonId);
            
            // Calcular datas m√≠nima e m√°xima
            const today = new Date();
            const maxDate = new Date();
            maxDate.setDate(today.getDate() + 10);
            
            const todayFormatted = today.toISOString().split('T')[0];
            const maxDateFormatted = maxDate.toISOString().split('T')[0];
            
            return `
                <div class="min-h-screen bg-white">
                    <div class="max-w-6xl mx-auto">
                        <!-- Header -->
                        <div class="flex items-center justify-between p-4 border-b border-gray-300">
                            <button 
                                class="text-black hover:bg-gray-50 p-2 rounded wecut-button-hover"
                                onclick="renderView('professional-profile-page')"
                            >
                                <i data-lucide="arrow-left" class="w-4 h-4 inline mr-2"></i>
                                Voltar
                            </button>
                        </div>

                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 p-6">
                            <!-- Left Column - Profile Info -->
                            <div class="lg:col-span-2 space-y-6">
                                <!-- Professional Header -->
                                <div class="flex items-start gap-6">
                                    <div class="w-24 h-24 rounded-full overflow-hidden flex-shrink-0">
                                        <img 
                                            src="${professional.profileImage}" 
                                            alt="${professional.name}"
                                            class="w-full h-full object-cover"
                                        />
                                    </div>
                                    <div class="flex-1">
                                        <h1 class="text-3xl font-medium text-black mb-1">${professional.name}</h1>
                                        <p class="text-lg text-gray-600 mb-2">${salon?.name || 'Sal√£o'}</p>
                                        <p class="text-gray-600 mb-3">${professional.specialty}</p>
                                        
                                        <div class="flex items-center gap-6 mb-4">
                                            <div class="flex items-center gap-2">
                                                <div class="flex gap-1">
                                                    ${Array(5).fill().map((_, i) => `
                                                        <i data-lucide="star" class="w-4 h-4 ${i < Math.floor(professional.rating) ? 'fill-yellow-400 stroke-yellow-400' : 'stroke-gray-300'}"></i>
                                                    `).join('')}
                                                </div>
                                                <span class="text-lg font-medium text-black">${professional.rating}</span>
                                                <span class="text-gray-600">(${professional.reviews} avalia√ß√µes)</span>
                                            </div>
                                            <div class="flex items-center gap-1 text-gray-600">
                                                <i data-lucide="map-pin" class="w-4 h-4"></i>
                                                <span>${professional.location}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Booking Form -->
                                <div class="border border-gray-300 rounded-lg p-6">
                                    <h3 class="text-xl font-medium text-black mb-4">Agendar Servi√ßo</h3>
                                    
                                    <form id="booking-form" onsubmit="confirmBooking(event)">
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                            <div>
                                                <label class="block text-sm font-medium text-black mb-2">Data</label>
                                                <input type="date" id="booking-date" required
                                                       class="w-full p-3 border border-gray-300 rounded-lg focus:border-black focus:ring-0"
                                                       min="${todayFormatted}"
                                                       max="${maxDateFormatted}">
                                                <p class="text-xs text-gray-500 mt-1">Datas dispon√≠veis: hoje at√© ${maxDate.toLocaleDateString('pt-BR')}</p>
                                            </div>
                                            <div>
                                                <label class="block text-sm font-medium text-black mb-2">Hor√°rio</label>
                                                <select id="booking-time" required
                                                        class="w-full p-3 border border-gray-300 rounded-lg focus:border-black focus:ring-0">
                                                    <option value="">Selecione um hor√°rio</option>
                                                    <option value="09:00">09:00</option>
                                                    <option value="10:00">10:00</option>
                                                    <option value="11:00">11:00</option>
                                                    <option value="14:00">14:00</option>
                                                    <option value="15:00">15:00</option>
                                                    <option value="16:00">16:00</option>
                                                </select>
                                            </div>
                                        </div>
                                        
                                        <div class="mb-4">
                                            <label class="block text-sm font-medium text-black mb-2">Servi√ßo</label>
                                            <select id="booking-service" required
                                                    class="w-full p-3 border border-gray-300 rounded-lg focus:border-black focus:ring-0">
                                                <option value="">Selecione um servi√ßo</option>
                                                ${professional.services.map(service => `
                                                    <option value="${service}">${service} - ${professional.price}</option>
                                                `).join('')}
                                            </select>
                                        </div>
                                        
                                        <div class="mb-4">
                                            <label class="block text-sm font-medium text-black mb-2">Observa√ß√µes (opcional)</label>
                                            <textarea id="booking-notes" rows="3"
                                                      class="w-full p-3 border border-gray-300 rounded-lg focus:border-black focus:ring-0"
                                                      placeholder="Alguma observa√ß√£o especial..."></textarea>
                                        </div>
                                        
                                        <button type="submit" 
                                                class="w-full bg-black text-white hover:bg-gray-800 py-3 rounded-lg wecut-button-hover">
                                            Confirmar Agendamento
                                        </button>
                                    </form>
                                </div>
                            </div>

                            <!-- Right Column - Summary -->
                            <div class="space-y-6">
                                <!-- Booking Summary -->
                                <div class="border border-gray-300 rounded-lg wecut-shadow p-6 sticky top-6">
                                    <h3 class="text-xl font-medium text-black mb-4">Resumo do Agendamento</h3>
                                    
                                    <div class="space-y-3 mb-4">
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">Profissional:</span>
                                            <span class="text-black">${professional.name}</span>
                                        </div>
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">Servi√ßo:</span>
                                            <span class="text-black" id="summary-service">-</span>
                                        </div>
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">Data:</span>
                                            <span class="text-black" id="summary-date">-</span>
                                        </div>
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">Hor√°rio:</span>
                                            <span class="text-black" id="summary-time">-</span>
                                        </div>
                                    </div>
                                    
                                    <div class="border-t border-gray-300 pt-4">
                                        <div class="flex justify-between text-lg font-medium">
                                            <span class="text-black">Total:</span>
                                            <span class="text-black" id="summary-price">-</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function confirmBooking(event) {
            event.preventDefault();
            
            const service = document.getElementById('booking-service').value;
            const date = document.getElementById('booking-date').value;
            const time = document.getElementById('booking-time').value;
            const notes = document.getElementById('booking-notes').value;
            
            if (!service || !date || !time) {
                alert('Por favor, preencha todos os campos obrigat√≥rios.');
                return;
            }
            
            // Validar data
            if (!validateBookingDate(date)) {
                return;
            }
            
            const professional = stateManager.state.professionals.find(p => p.id === stateManager.state.bookingProfessionalId);
            const salon = stateManager.state.salons.find(s => s.id === professional.salonId);
            
            const newAppointment = {
                professionalId: stateManager.state.bookingProfessionalId || 1,
                clientName: stateManager.state.currentUser ? stateManager.state.currentUser.name : 'Cliente',
                service: service,
                date: new Date(date).toISOString(),
                time: time,
                price: professional.price,
                status: 'pending',
                notes: notes,
                location: professional.location,
                phone: salon?.phone || '+258 84 123 4567',
                address: salon?.address || 'Endere√ßo n√£o dispon√≠vel',
                image: professional.profileImage
            };
            
            stateManager.addAppointment(newAppointment);
            
            alert(`üìÖ Agendamento solicitado! C√≥digo: ${newAppointment.code}\n\nO profissional ser√° notificado e voc√™ receber√° uma confirma√ß√£o em breve.`);
            renderView('appointments-page');
        }

        function getAppointmentsPageContent() {
            const appointments = stateManager.getUserAppointments(stateManager.state.currentUser?.id);
            const upcomingAppointments = appointments.filter(apt => apt.status === 'pending' || apt.status === 'accepted');
            const historyAppointments = appointments.filter(apt => apt.status === 'completed' || apt.status === 'rejected' || apt.status === 'rated');
            
            return `
                <div class="min-h-screen bg-gray-50">
                    <div class="max-w-6xl mx-auto px-4 py-8">
                        <!-- Header -->
                        <div class="mb-8">
                            <h1 class="text-3xl text-black mb-2">Meus Agendamentos</h1>
                            <p class="text-gray-600">Gerencie seus agendamentos e hist√≥rico de servi√ßos</p>
                        </div>

                        <!-- Quick Stats -->
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                            <div class="border border-gray-300 rounded-lg p-6 text-center bg-white">
                                <div class="flex items-center justify-center mb-2">
                                    <i data-lucide="calendar" class="w-6 h-6 text-blue-600"></i>
                                </div>
                                <p class="text-2xl text-black">${upcomingAppointments.length}</p>
                                <p class="text-sm text-gray-600">Pr√≥ximos agendamentos</p>
                            </div>
                            
                            <div class="border border-gray-300 rounded-lg p-6 text-center bg-white">
                                <div class="flex items-center justify-center mb-2">
                                    <i data-lucide="check-circle" class="w-6 h-6 text-green-600"></i>
                                </div>
                                <p class="text-2xl text-black">${appointments.filter(apt => apt.status === 'completed').length}</p>
                                <p class="text-sm text-gray-600">Servi√ßos realizados</p>
                            </div>
                            
                            <div class="border border-gray-300 rounded-lg p-6 text-center bg-white">
                                <div class="flex items-center justify-center mb-2">
                                    <i data-lucide="star" class="w-6 h-6 text-yellow-600"></i>
                                </div>
                                <p class="text-2xl text-black">${appointments.filter(apt => apt.status === 'rated').length}</p>
                                <p class="text-sm text-gray-600">Avaliados</p>
                            </div>
                        </div>

                        <!-- Tabs -->
                        <div class="bg-white rounded-lg border border-gray-300">
                            <div class="border-b border-gray-300">
                                <div class="flex">
                                    <button class="flex-1 py-4 text-center border-b-2 border-black text-black font-medium" onclick="switchAppointmentTab('upcoming')">Pr√≥ximos</button>
                                    <button class="flex-1 py-4 text-center text-gray-600 hover:text-black" onclick="switchAppointmentTab('history')">Hist√≥rico</button>
                                </div>
                            </div>
                            
                            <div class="p-6">
                                <div id="upcoming-appointments" class="space-y-6">
                                    ${upcomingAppointments.length > 0 ? upcomingAppointments.map(appointment => {
                                        const professional = stateManager.state.professionals.find(p => p.id === appointment.professionalId);
                                        return `
                                            <div class="border border-gray-300 rounded-lg hover:shadow-lg transition-shadow p-6">
                                                <div class="flex items-start gap-4">
                                                    <div class="w-16 h-16 rounded-full overflow-hidden flex-shrink-0">
                                                        <img 
                                                            src="${professional?.profileImage || appointment.image}" 
                                                            alt="${professional?.name || 'Profissional'}"
                                                            class="w-full h-full object-cover"
                                                        />
                                                    </div>
                                                    
                                                    <div class="flex-1">
                                                        <div class="flex items-start justify-between mb-3">
                                                            <div>
                                                                <h3 class="text-lg text-black">${professional?.name || 'Profissional'}</h3>
                                                                <p class="text-gray-600">${appointment.service}</p>
                                                                <p class="text-sm text-gray-500">C√≥digo: ${appointment.code}</p>
                                                            </div>
                                                            <div class="text-right">
                                                                <p class="text-lg text-black">${appointment.price}</p>
                                                                <span class="px-2 py-1 rounded-full text-xs ${getAppointmentStatusBadgeClass(appointment.status)}">
                                                                    ${getAppointmentStatusText(appointment.status)}
                                                                </span>
                                                            </div>
                                                        </div>

                                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4 text-sm">
                                                            <div class="flex items-center gap-2 text-gray-600">
                                                                <i data-lucide="calendar" class="w-4 h-4"></i>
                                                                <span>${new Date(appointment.date).toLocaleDateString('pt-BR', { weekday: 'long', day: 'numeric', month: 'long' })}</span>
                                                            </div>
                                                            <div class="flex items-center gap-2 text-gray-600">
                                                                <i data-lucide="clock" class="w-4 h-4"></i>
                                                                <span>${appointment.time}</span>
                                                            </div>
                                                            <div class="flex items-center gap-2 text-gray-600">
                                                                <i data-lucide="map-pin" class="w-4 h-4"></i>
                                                                <span>${appointment.location}</span>
                                                            </div>
                                                            <div class="flex items-center gap-2 text-gray-600">
                                                                <i data-lucide="phone" class="w-4 h-4"></i>
                                                                <span>${appointment.phone}</span>
                                                            </div>
                                                        </div>

                                                        <p class="text-sm text-gray-600 mb-4">${appointment.address}</p>

                                                        <div class="flex flex-wrap gap-2">
                                                            <button class="border border-gray-300 hover:bg-gray-50 px-3 py-1 rounded text-sm wecut-button-hover">
                                                                <i data-lucide="message-circle" class="w-4 h-4 inline mr-2"></i>
                                                                Mensagem
                                                            </button>
                                                            <button class="border border-gray-300 hover:bg-gray-50 px-3 py-1 rounded text-sm wecut-button-hover">
                                                                <i data-lucide="navigation" class="w-4 h-4 inline mr-2"></i>
                                                                Dire√ß√µes
                                                            </button>
                                                            ${appointment.status === 'accepted' ? `
                                                                <button onclick="completeAppointment(${appointment.id})" class="bg-green-600 text-white hover:bg-green-700 px-3 py-1 rounded text-sm wecut-button-hover">
                                                                    <i data-lucide="check-circle" class="w-4 h-4 inline mr-2"></i>
                                                                    Finalizado
                                                                </button>
                                                            ` : ''}
                                                            <button class="border border-red-200 hover:bg-red-50 text-red-600 px-3 py-1 rounded text-sm wecut-button-hover">
                                                                <i data-lucide="x-circle" class="w-4 h-4 inline mr-2"></i>
                                                                Cancelar
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        `;
                                    }).join('') : `
                                        <div class="text-center py-12">
                                            <i data-lucide="calendar" class="w-16 h-16 text-gray-400 mx-auto mb-4"></i>
                                            <h3 class="text-lg font-medium text-gray-900 mb-2">Nenhum agendamento pr√≥ximo</h3>
                                            <p class="text-gray-600">Voc√™ n√£o tem agendamentos em andamento.</p>
                                        </div>
                                    `}
                                </div>

                                <div id="history-appointments" class="hidden space-y-6">
                                    ${historyAppointments.length > 0 ? historyAppointments.map(appointment => {
                                        const professional = stateManager.state.professionals.find(p => p.id === appointment.professionalId);
                                        return `
                                            <div class="border border-gray-300 rounded-lg hover:shadow-lg transition-shadow p-6">
                                                <div class="flex items-start gap-4">
                                                    <div class="w-16 h-16 rounded-full overflow-hidden flex-shrink-0">
                                                        <img 
                                                            src="${professional?.profileImage || appointment.image}" 
                                                            alt="${professional?.name || 'Profissional'}"
                                                            class="w-full h-full object-cover"
                                                        />
                                                    </div>
                                                    
                                                    <div class="flex-1">
                                                        <div class="flex items-start justify-between mb-3">
                                                            <div>
                                                                <h3 class="text-lg text-black">${professional?.name || 'Profissional'}</h3>
                                                                <p class="text-gray-600">${appointment.service}</p>
                                                                <p class="text-sm text-gray-500">C√≥digo: ${appointment.code}</p>
                                                            </div>
                                                            <div class="text-right">
                                                                <p class="text-lg text-black">${appointment.price}</p>
                                                                <span class="px-2 py-1 rounded-full text-xs ${getAppointmentStatusBadgeClass(appointment.status)}">
                                                                    ${getAppointmentStatusText(appointment.status)}
                                                                </span>
                                                            </div>
                                                        </div>

                                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4 text-sm">
                                                            <div class="flex items-center gap-2 text-gray-600">
                                                                <i data-lucide="calendar" class="w-4 h-4"></i>
                                                                <span>${new Date(appointment.date).toLocaleDateString('pt-BR', { weekday: 'long', day: 'numeric', month: 'long' })}</span>
                                                            </div>
                                                            <div class="flex items-center gap-2 text-gray-600">
                                                                <i data-lucide="clock" class="w-4 h-4"></i>
                                                                <span>${appointment.time}</span>
                                                            </div>
                                                            <div class="flex items-center gap-2 text-gray-600">
                                                                <i data-lucide="map-pin" class="w-4 h-4"></i>
                                                                <span>${appointment.location}</span>
                                                            </div>
                                                        </div>

                                                        ${appointment.notes ? `<p class="text-sm text-gray-600 mb-4"><strong>Observa√ß√µes:</strong> ${appointment.notes}</p>` : ''}

                                                        <div class="flex flex-wrap gap-2">
                                                            ${appointment.status === 'completed' && appointment.status !== 'rated' ? `
                                                                <button onclick="openRatingModal(${appointment.id})" class="bg-yellow-600 text-white hover:bg-yellow-700 px-3 py-1 rounded text-sm wecut-button-hover">
                                                                    <i data-lucide="star" class="w-4 h-4 inline mr-2"></i>
                                                                    Avaliar
                                                                </button>
                                                            ` : ''}
                                                            ${appointment.status === 'rated' ? `
                                                                <span class="bg-green-100 text-green-800 px-3 py-1 rounded text-sm">
                                                                    <i data-lucide="check" class="w-4 h-4 inline mr-2"></i>
                                                                    Avaliado
                                                                </span>
                                                            ` : ''}
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        `;
                                    }).join('') : `
                                        <div class="text-center py-12">
                                            <i data-lucide="calendar" class="w-16 h-16 text-gray-400 mx-auto mb-4"></i>
                                            <h3 class="text-lg font-medium text-gray-900 mb-2">Nenhum hist√≥rico</h3>
                                            <p class="text-gray-600">Voc√™ n√£o tem agendamentos no hist√≥rico.</p>
                                        </div>
                                    `}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function switchAppointmentTab(tab) {
            document.getElementById('upcoming-appointments').classList.add('hidden');
            document.getElementById('history-appointments').classList.add('hidden');
            
            document.getElementById(tab + '-appointments').classList.remove('hidden');
            
            // Atualizar tabs ativas
            document.querySelectorAll('.border-b-2').forEach(tab => {
                tab.classList.remove('border-black', 'text-black', 'font-medium');
                tab.classList.add('text-gray-600');
            });
            
            event.target.classList.add('border-black', 'text-black', 'font-medium');
            event.target.classList.remove('text-gray-600');
        }

        function getProfessionalDashboardContent() {
            const professional = stateManager.state.professionals.find(p => p.userId === stateManager.state.currentUser?.id);
            const appointments = stateManager.getProfessionalAppointments(professional?.id);
            const pendingAppointments = appointments.filter(apt => apt.status === 'pending');
            const acceptedAppointments = appointments.filter(apt => apt.status === 'accepted');
            const completedAppointments = appointments.filter(apt => apt.status === 'completed');
            
            // Estat√≠sticas
            const totalEarnings = completedAppointments.reduce((sum, apt) => {
                const price = parseFloat(apt.price.replace('MT', '').replace(',', '').trim());
                return sum + (isNaN(price) ? 0 : price);
            }, 0);
            
            return `
                <div class="min-h-screen bg-gray-50">
                    <div class="max-w-7xl mx-auto px-4 py-8">
                        <!-- Header -->
                        <div class="mb-8">
                            <div class="flex justify-between items-start">
                                <div>
                                    <h1 class="text-3xl font-bold text-gray-900">Dashboard Profissional</h1>
                                    <p class="text-gray-600">Gerencie seus agendamentos e servi√ßos</p>
                                </div>
                            </div>
                            
                            <!-- Banner de Status -->
                            <div class="mt-4 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded">
                                <p>‚úÖ Seu perfil est√° ativo e vis√≠vel para clientes</p>
                            </div>
                            
                            ${pendingAppointments.length > 0 ? `
                                <div class="mt-4 bg-blue-100 border border-blue-400 text-blue-700 px-4 py-3 rounded">
                                    <p>üì¨ Voc√™ tem <strong>${pendingAppointments.length}</strong> novo(s) agendamento(s) para confirmar</p>
                                </div>
                            ` : ''}
                        </div>

                        <!-- Stats -->
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                            <div class="bg-white p-6 rounded-lg border border-gray-300 shadow-sm">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <p class="text-2xl font-bold text-gray-900">${appointments.length}</p>
                                        <p class="text-gray-600">Total Agendamentos</p>
                                    </div>
                                    <i data-lucide="calendar" class="w-8 h-8 text-blue-600"></i>
                                </div>
                            </div>
                            <div class="bg-white p-6 rounded-lg border border-gray-300 shadow-sm">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <p class="text-2xl font-bold text-gray-900">${pendingAppointments.length}</p>
                                        <p class="text-gray-600">Pendentes</p>
                                    </div>
                                    <i data-lucide="clock" class="w-8 h-8 text-yellow-600"></i>
                                </div>
                            </div>
                            <div class="bg-white p-6 rounded-lg border border-gray-300 shadow-sm">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <p class="text-2xl font-bold text-gray-900">${completedAppointments.length}</p>
                                        <p class="text-gray-600">Finalizados</p>
                                    </div>
                                    <i data-lucide="check-circle" class="w-8 h-8 text-green-600"></i>
                                </div>
                            </div>
                            <div class="bg-white p-6 rounded-lg border border-gray-300 shadow-sm">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <p class="text-2xl font-bold text-gray-900">${totalEarnings.toFixed(2)} MT</p>
                                        <p class="text-gray-600">Total Ganho</p>
                                    </div>
                                    <i data-lucide="dollar-sign" class="w-8 h-8 text-purple-600"></i>
                                </div>
                            </div>
                        </div>

                        <!-- Tabs -->
                        <div class="bg-white rounded-lg border border-gray-300 shadow-sm">
                            <div class="border-b border-gray-300">
                                <div class="flex overflow-x-auto">
                                    <button class="px-6 py-4 border-b-2 whitespace-nowrap ${stateManager.state.professionalTab === 'pending' ? 'border-black text-black font-medium' : 'text-gray-600 hover:text-black'}" 
                                            onclick="switchProfessionalTab('pending')">
                                        <i data-lucide="clock" class="w-4 h-4 inline mr-2"></i>
                                        Pendentes
                                        ${pendingAppointments.length > 0 ? `
                                            <span class="ml-2 bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded-full">${pendingAppointments.length}</span>
                                        ` : ''}
                                    </button>
                                    <button class="px-6 py-4 border-b-2 whitespace-nowrap ${stateManager.state.professionalTab === 'accepted' ? 'border-black text-black font-medium' : 'text-gray-600 hover:text-black'}" 
                                            onclick="switchProfessionalTab('accepted')">
                                        <i data-lucide="check-circle" class="w-4 h-4 inline mr-2"></i>
                                        Aceites
                                    </button>
                                    <button class="px-6 py-4 border-b-2 whitespace-nowrap ${stateManager.state.professionalTab === 'completed' ? 'border-black text-black font-medium' : 'text-gray-600 hover:text-black'}" 
                                            onclick="switchProfessionalTab('completed')">
                                        <i data-lucide="check-square" class="w-4 h-4 inline mr-2"></i>
                                        Servi√ßos Finalizados
                                    </button>
                                    <button class="px-6 py-4 border-b-2 whitespace-nowrap ${stateManager.state.professionalTab === 'report' ? 'border-black text-black font-medium' : 'text-gray-600 hover:text-black'}" 
                                            onclick="switchProfessionalTab('report')">
                                        <i data-lucide="file-text" class="w-4 h-4 inline mr-2"></i>
                                        Relat√≥rio Completo
                                    </button>
                                </div>
                            </div>
                            
                            <div class="p-6">
                                ${getProfessionalTabContent(appointments)}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function getProfessionalTabContent(appointments) {
            switch(stateManager.state.professionalTab) {
                case 'pending':
                    const pendingAppointments = appointments.filter(apt => apt.status === 'pending');
                    return renderAppointmentsList(pendingAppointments, 'pending');
                    
                case 'accepted':
                    const acceptedAppointments = appointments.filter(apt => apt.status === 'accepted');
                    return renderAppointmentsList(acceptedAppointments, 'accepted');
                    
                case 'completed':
                    const completedAppointments = appointments.filter(apt => apt.status === 'completed');
                    return renderAppointmentsList(completedAppointments, 'completed');
                    
                case 'report':
                    return renderProfessionalReport();
                    
                default:
                    return '<p class="text-gray-600">Conte√∫do n√£o dispon√≠vel</p>';
            }
        }

        function renderAppointmentsList(appointments, type) {
            if (appointments.length === 0) {
                return `
                    <div class="text-center py-12">
                        <i data-lucide="calendar" class="w-16 h-16 text-gray-400 mx-auto mb-4"></i>
                        <h3 class="text-lg font-medium text-gray-900 mb-2">Nenhum agendamento</h3>
                        <p class="text-gray-600">${type === 'pending' ? 'N√£o h√° agendamentos pendentes.' : type === 'accepted' ? 'N√£o h√° agendamentos aceites.' : 'N√£o h√° servi√ßos finalizados.'}</p>
                    </div>
                `;
            }
            
            return `
                <div class="space-y-4">
                    ${appointments.map(apt => `
                        <div class="border border-gray-300 rounded-lg p-4 hover:shadow-md transition-shadow">
                            <div class="flex items-center justify-between mb-3">
                                <div>
                                    <h3 class="font-medium text-gray-900">${apt.clientName}</h3>
                                    <p class="text-gray-600">${apt.service} ‚Ä¢ ${apt.time}</p>
                                    <p class="text-sm text-gray-500">C√≥digo: ${apt.code}</p>
                                </div>
                                <span class="px-3 py-1 rounded-full text-sm ${getAppointmentStatusBadgeClass(apt.status)}">
                                    ${getAppointmentStatusText(apt.status)}
                                </span>
                            </div>
                            
                            <div class="text-sm text-gray-600 mb-3">
                                <p><strong>Data:</strong> ${new Date(apt.date).toLocaleDateString('pt-BR')}</p>
                                <p><strong>Hora:</strong> ${apt.time}</p>
                                <p><strong>Valor:</strong> ${apt.price}</p>
                                <p><strong>Contacto:</strong> ${apt.phone}</p>
                                <p><strong>Local:</strong> ${apt.address}</p>
                                ${apt.notes ? `<p><strong>Observa√ß√µes:</strong> ${apt.notes}</p>` : ''}
                            </div>
                            
                            <div class="flex gap-2">
                                ${type === 'pending' ? `
                                    <button onclick="acceptAppointment(${apt.id})" class="bg-green-600 text-white hover:bg-green-700 px-4 py-2 rounded text-sm wecut-button-hover">
                                        <i data-lucide="check" class="w-4 h-4 inline mr-1"></i>
                                        Aceitar
                                    </button>
                                    <button onclick="rejectAppointment(${apt.id})" class="bg-red-600 text-white hover:bg-red-700 px-4 py-2 rounded text-sm wecut-button-hover">
                                        <i data-lucide="x" class="w-4 h-4 inline mr-1"></i>
                                        Recusar
                                    </button>
                                ` : ''}
                                ${type === 'accepted' ? `
                                    <button onclick="completeAppointment(${apt.id})" class="bg-blue-600 text-white hover:bg-blue-700 px-4 py-2 rounded text-sm wecut-button-hover">
                                        <i data-lucide="check-circle" class="w-4 h-4 inline mr-1"></i>
                                        Finalizado
                                    </button>
                                ` : ''}
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function renderProfessionalReport() {
            const professional = stateManager.state.professionals.find(p => p.userId === stateManager.state.currentUser?.id);
            const appointments = stateManager.getProfessionalAppointments(professional?.id);
            const completedAppointments = appointments.filter(apt => apt.status === 'completed');
            
            const totalEarnings = completedAppointments.reduce((sum, apt) => {
                const price = parseFloat(apt.price.replace('MT', '').replace(',', '').trim());
                return sum + (isNaN(price) ? 0 : price);
            }, 0);

            return `
                <div class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="bg-white p-4 rounded-lg border border-gray-300">
                            <p class="text-2xl font-bold text-gray-900">${completedAppointments.length}</p>
                            <p class="text-gray-600">Total de Servi√ßos</p>
                        </div>
                        <div class="bg-white p-4 rounded-lg border border-gray-300">
                            <p class="text-2xl font-bold text-gray-900">${totalEarnings.toFixed(2)} MT</p>
                            <p class="text-gray-600">Total Ganho</p>
                        </div>
                        <div class="bg-white p-4 rounded-lg border border-gray-300">
                            <p class="text-2xl font-bold text-gray-900">${professional.rating}</p>
                            <p class="text-gray-600">Avalia√ß√£o M√©dia</p>
                        </div>
                    </div>

                    <button onclick="downloadProfessionalReport()" class="bg-blue-600 text-white hover:bg-blue-700 px-4 py-2 rounded wecut-button-hover">
                        <i data-lucide="download" class="w-4 h-4 inline mr-2"></i>
                        Baixar Relat√≥rio Completo
                    </button>

                    <div class="bg-white rounded-lg border border-gray-300 p-4">
                        <h4 class="font-medium text-black mb-4">Hist√≥rico de Servi√ßos</h4>
                        <div class="space-y-4">
                            ${completedAppointments.map(apt => `
                                <div class="flex justify-between items-center border-b border-gray-200 pb-2">
                                    <div>
                                        <p class="font-medium">${apt.clientName}</p>
                                        <p class="text-sm text-gray-600">${apt.service} - ${new Date(apt.date).toLocaleDateString('pt-BR')}</p>
                                    </div>
                                    <span class="font-medium">${apt.price}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
        }

        function getAdminDashboardContent() {
            const professionals = stateManager.getApprovedProfessionals();
            const totalUsers = stateManager.state.users.length;
            const totalAppointments = stateManager.state.appointments.length;
            
            return `
                <div class="min-h-screen bg-gray-50">
                    <div class="max-w-7xl mx-auto px-4 py-8">
                        <!-- Header -->
                        <div class="flex justify-between items-center mb-8">
                            <div>
                                <h1 class="text-3xl font-bold text-gray-900">Painel Administrativo</h1>
                                <p class="text-gray-600">Gerencie profissionais e usu√°rios do sistema</p>
                            </div>
                            <button onclick="downloadAdminReport()" class="bg-blue-600 text-white hover:bg-blue-700 px-4 py-2 rounded-lg wecut-button-hover">
                                <i data-lucide="download" class="w-4 h-4 inline mr-2"></i>
                                Baixar Relat√≥rio
                            </button>
                        </div>

                        <!-- Stats -->
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                            <div class="bg-white p-6 rounded-lg border border-gray-300 shadow-sm">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <p class="text-2xl font-bold text-gray-900">${totalUsers}</p>
                                        <p class="text-gray-600">Total de Usu√°rios</p>
                                    </div>
                                    <i data-lucide="users" class="w-8 h-8 text-blue-600"></i>
                                </div>
                            </div>
                            <div class="bg-white p-6 rounded-lg border border-gray-300 shadow-sm">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <p class="text-2xl font-bold text-gray-900">${professionals.length}</p>
                                        <p class="text-gray-600">Profissionais Cadastrados</p>
                                    </div>
                                    <i data-lucide="scissors" class="w-8 h-8 text-green-600"></i>
                                </div>
                            </div>
                            <div class="bg-white p-6 rounded-lg border border-gray-300 shadow-sm">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <p class="text-2xl font-bold text-gray-900">${totalAppointments}</p>
                                        <p class="text-gray-600">Total de Agendamentos</p>
                                    </div>
                                    <i data-lucide="calendar" class="w-8 h-8 text-purple-600"></i>
                                </div>
                            </div>
                        </div>

                        <!-- Tabs -->
                        <div class="bg-white rounded-lg border border-gray-300 shadow-sm">
                            <div class="border-b border-gray-300">
                                <div class="flex overflow-x-auto">
                                    <button id="professionals-tab" class="px-6 py-4 border-b-2 whitespace-nowrap ${stateManager.state.adminTab === 'professionals' ? 'border-black text-black font-medium' : 'text-gray-600 hover:text-black'}">
                                        <i data-lucide="scissors" class="w-4 h-4 inline mr-2"></i>
                                        Profissionais Cadastrados
                                    </button>
                                    <button id="appointments-tab" class="px-6 py-4 border-b-2 whitespace-nowrap ${stateManager.state.adminTab === 'appointments' ? 'border-black text-black font-medium' : 'text-gray-600 hover:text-black'}">
                                        <i data-lucide="calendar" class="w-4 h-4 inline mr-2"></i>
                                        Agendamentos
                                    </button>
                                </div>
                            </div>
                            
                            <div class="p-6">
                                ${getAdminTabContent()}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function getAdminTabContent() {
            const professionals = stateManager.getApprovedProfessionals();
            const appointments = stateManager.state.appointments;
            
            switch(stateManager.state.adminTab) {
                case 'professionals':
                    return `
                        <div>
                            <h2 class="text-xl font-semibold text-gray-900 mb-6">Todos os Profissionais Cadastrados</h2>
                            
                            ${professionals.length === 0 ? `
                                <div class="text-center py-12">
                                    <i data-lucide="user-x" class="w-16 h-16 text-gray-400 mx-auto mb-4"></i>
                                    <h3 class="text-lg font-medium text-gray-900 mb-2">Nenhum profissional cadastrado</h3>
                                    <p class="text-gray-600">Ainda n√£o h√° profissionais cadastrados no sistema.</p>
                                </div>
                            ` : `
                                <div class="overflow-x-auto">
                                    <table class="w-full border-collapse">
                                        <thead>
                                            <tr class="border-b border-gray-300 bg-gray-50">
                                                <th class="text-left py-3 px-4 text-black font-medium">ID</th>
                                                <th class="text-left py-3 px-4 text-black font-medium">Profissional</th>
                                                <th class="text-left py-3 px-4 text-black font-medium">Sal√£o</th>
                                                <th class="text-left py-3 px-4 text-black font-medium">Localiza√ß√£o</th>
                                                <th class="text-left py-3 px-4 text-black font-medium">Contacto</th>
                                                <th class="text-left py-3 px-4 text-black font-medium">Servi√ßos</th>
                                                <th class="text-left py-3 px-4 text-black font-medium">Data de Cadastro</th>
                                                <th class="text-left py-3 px-4 text-black font-medium">A√ß√µes</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            ${professionals.map(professional => {
                                                const user = stateManager.state.users.find(u => u.id === professional.userId);
                                                const salon = stateManager.state.salons.find(s => s.id === professional.salonId);
                                                return `
                                                    <tr class="border-b border-gray-200 hover:bg-gray-50">
                                                        <td class="py-3 px-4 font-mono text-sm">${professional.id}</td>
                                                        <td class="py-3 px-4">
                                                            <div class="flex items-center gap-3">
                                                                <div class="w-10 h-10 rounded-full overflow-hidden flex-shrink-0">
                                                                    <img src="${professional.profileImage}" alt="${professional.name}" class="w-full h-full object-cover">
                                                                </div>
                                                                <div>
                                                                    <div class="font-medium text-gray-900">${professional.name}</div>
                                                                    <div class="text-sm text-gray-600">${professional.specialty}</div>
                                                                </div>
                                                            </div>
                                                        </td>
                                                        <td class="py-3 px-4">
                                                            <div class="font-medium text-gray-900">${salon?.name || 'N/A'}</div>
                                                            <div class="text-sm text-gray-600">${salon?.address || 'N/A'}</div>
                                                        </td>
                                                        <td class="py-3 px-4">${salon?.location || 'N/A'}</td>
                                                        <td class="py-3 px-4">
                                                            <div class="text-sm">${salon?.phone || 'N/A'}</div>
                                                            <div class="text-xs text-gray-600">${user?.email || 'N/A'}</div>
                                                        </td>
                                                        <td class="py-3 px-4">
                                                            <div class="flex flex-wrap gap-1 max-w-xs">
                                                                ${professional.services.slice(0, 3).map(service => `
                                                                    <span class="bg-gray-100 text-gray-800 text-xs px-2 py-1 rounded">${service}</span>
                                                                `).join('')}
                                                                ${professional.services.length > 3 ? `
                                                                    <span class="text-xs text-gray-500">+${professional.services.length - 3}</span>
                                                                ` : ''}
                                                            </div>
                                                        </td>
                                                        <td class="py-3 px-4 text-sm">${new Date().toLocaleDateString('pt-BR')}</td>
                                                        <td class="py-3 px-4">
                                                            <button onclick="viewProfessionalDetails(${professional.id})" class="text-blue-600 hover:text-blue-800">
                                                                <i data-lucide="eye" class="w-4 h-4"></i>
                                                            </button>
                                                        </td>
                                                    </tr>
                                                `;
                                            }).join('')}
                                        </tbody>
                                    </table>
                                </div>
                            `}
                        </div>
                    `;
                    
                case 'appointments':
                    return `
                        <div>
                            <h2 class="text-xl font-semibold text-gray-900 mb-6">Todos os Agendamentos</h2>
                            
                            ${appointments.length === 0 ? `
                                <div class="text-center py-12">
                                    <i data-lucide="calendar" class="w-16 h-16 text-gray-400 mx-auto mb-4"></i>
                                    <h3 class="text-lg font-medium text-gray-900 mb-2">Nenhum agendamento</h3>
                                    <p class="text-gray-600">Ainda n√£o h√° agendamentos no sistema.</p>
                                </div>
                            ` : `
                                <div class="overflow-x-auto">
                                    <table class="w-full border-collapse">
                                        <thead>
                                            <tr class="border-b border-gray-300 bg-gray-50">
                                                <th class="text-left py-3 px-4 text-black font-medium">C√≥digo</th>
                                                <th class="text-left py-3 px-4 text-black font-medium">Cliente</th>
                                                <th class="text-left py-3 px-4 text-black font-medium">Servi√ßo</th>
                                                <th class="text-left py-3 px-4 text-black font-medium">Profissional</th>
                                                <th class="text-left py-3 px-4 text-black font-medium">Data/Hora</th>
                                                <th class="text-left py-3 px-4 text-black font-medium">Valor</th>
                                                <th class="text-left py-3 px-4 text-black font-medium">Status</th>
                                                <th class="text-left py-3 px-4 text-black font-medium">A√ß√µes</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            ${appointments.map(appointment => {
                                                const professional = stateManager.state.professionals.find(p => p.id === appointment.professionalId);
                                                return `
                                                    <tr class="border-b border-gray-200 hover:bg-gray-50">
                                                        <td class="py-3 px-4 font-mono text-sm">${appointment.code}</td>
                                                        <td class="py-3 px-4">
                                                            <div class="font-medium text-gray-900">${appointment.clientName}</div>
                                                            <div class="text-sm text-gray-600">${appointment.phone}</div>
                                                        </td>
                                                        <td class="py-3 px-4">${appointment.service}</td>
                                                        <td class="py-3 px-4">
                                                            <div class="font-medium text-gray-900">${professional?.name || 'N/A'}</div>
                                                            <div class="text-sm text-gray-600">${appointment.location}</div>
                                                        </td>
                                                        <td class="py-3 px-4">
                                                            <div class="font-medium text-gray-900">${new Date(appointment.date).toLocaleDateString('pt-BR')}</div>
                                                            <div class="text-sm text-gray-600">${appointment.time}</div>
                                                        </td>
                                                        <td class="py-3 px-4 font-medium">${appointment.price}</td>
                                                        <td class="py-3 px-4">
                                                            <span class="px-2 py-1 rounded-full text-xs ${getAppointmentStatusBadgeClass(appointment.status)}">
                                                                ${getAppointmentStatusText(appointment.status)}
                                                            </span>
                                                        </td>
                                                        <td class="py-3 px-4">
                                                            ${appointment.status === 'accepted' ? `
                                                                <button onclick="completeAppointment(${appointment.id})" class="bg-blue-600 text-white hover:bg-blue-700 px-3 py-1 rounded text-sm wecut-button-hover">
                                                                    Finalizado
                                                                </button>
                                                            ` : ''}
                                                        </td>
                                                    </tr>
                                                `;
                                            }).join('')}
                                        </tbody>
                                    </table>
                                </div>
                            `}
                        </div>
                    `;
                    
                default:
                    return '<p class="text-gray-600">Conte√∫do n√£o dispon√≠vel</p>';
            }
        }

        // Fun√ß√µes auxiliares
        function getAppointmentStatusBadgeClass(status) {
            switch(status) {
                case 'pending': return 'bg-yellow-100 text-yellow-800';
                case 'accepted': return 'bg-green-100 text-green-800';
                case 'rejected': return 'bg-red-100 text-red-800';
                case 'completed': return 'bg-blue-100 text-blue-800';
                case 'rated': return 'bg-purple-100 text-purple-800';
                default: return 'bg-gray-100 text-gray-800';
            }
        }

        function getAppointmentStatusText(status) {
            switch(status) {
                case 'pending': return 'Pendente';
                case 'accepted': return 'Aceite';
                case 'rejected': return 'Recusado';
                case 'completed': return 'Finalizado';
                case 'rated': return 'Avaliado';
                default: return 'Desconhecido';
            }
        }

        function acceptAppointment(appointmentId) {
            if (stateManager.updateAppointmentStatus(appointmentId, 'accepted')) {
                alert('‚úÖ Agendamento aceito com sucesso!');
                renderView('professional-dashboard-page');
            }
        }

        function rejectAppointment(appointmentId) {
            if (stateManager.updateAppointmentStatus(appointmentId, 'rejected')) {
                alert('‚ùå Agendamento recusado!');
                renderView('professional-dashboard-page');
            }
        }

        function completeAppointment(appointmentId) {
            if (stateManager.updateAppointmentStatus(appointmentId, 'completed')) {
                alert('‚úÖ Agendamento marcado como finalizado!');
                renderView('professional-dashboard-page');
            }
        }

        function viewProfessionalDetails(professionalId) {
            const professional = stateManager.state.professionals.find(p => p.id === professionalId);
            const salon = stateManager.state.salons.find(s => s.id === professional.salonId);
            
            document.getElementById('professional-details-title').textContent = `Detalhes - ${professional.name}`;
            
            document.getElementById('professional-details-content').innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <h4 class="font-medium text-black mb-2">Informa√ß√µes do Profissional</h4>
                        <div class="space-y-2 text-sm">
                            <p><strong>Nome:</strong> ${professional.name}</p>
                            <p><strong>Especialidade:</strong> ${professional.specialty}</p>
                            <p><strong>Descri√ß√£o:</strong> ${professional.description}</p>
                            <p><strong>Avalia√ß√£o:</strong> ‚≠ê ${professional.rating} (${professional.reviews} avalia√ß√µes)</p>
                        </div>
                    </div>
                    
                    <div>
                        <h4 class="font-medium text-black mb-2">Informa√ß√µes do Sal√£o</h4>
                        <div class="space-y-2 text-sm">
                            <p><strong>Nome:</strong> ${salon?.name || 'N/A'}</p>
                            <p><strong>Localiza√ß√£o:</strong> ${salon?.location || 'N/A'}</p>
                            <p><strong>Endere√ßo:</strong> ${salon?.address || 'N/A'}</p>
                            <p><strong>Telefone:</strong> ${salon?.phone || 'N/A'}</p>
                            <p><strong>Hor√°rio:</strong> ${salon?.openingHours?.opening || '09:00'} - ${salon?.openingHours?.closing || '18:00'}</p>
                        </div>
                    </div>
                </div>
                
                <div>
                    <h4 class="font-medium text-black mb-2">Servi√ßos Oferecidos</h4>
                    <div class="flex flex-wrap gap-2">
                        ${professional.services.map(service => `
                            <span class="bg-gray-100 text-gray-800 px-3 py-1 rounded-full text-sm">${service}</span>
                        `).join('')}
                    </div>
                </div>
            `;
            
            document.getElementById('remove-from-details').onclick = function() {
                if (confirm(`Tem certeza que deseja remover ${professional.name}?`)) {
                    if (stateManager.removeProfessional(professionalId)) {
                        alert('‚úÖ Profissional removido com sucesso!');
                        closeProfessionalDetailsModal();
                        renderView('admin-dashboard-page');
                    }
                }
            };
            
            document.getElementById('professional-details-modal').classList.remove('hidden');
        }

        function closeProfessionalDetailsModal() {
            document.getElementById('professional-details-modal').classList.add('hidden');
        }

        function openRatingModal(appointmentId) {
            document.getElementById('rating-appointment-id').value = appointmentId;
            document.getElementById('rating-modal').classList.remove('hidden');
        }

        function closeRatingModal() {
            document.getElementById('rating-modal').classList.add('hidden');
            document.getElementById('rating-form').reset();
        }

        function submitRating(event) {
            event.preventDefault();
            
            const appointmentId = parseInt(document.getElementById('rating-appointment-id').value);
            const rating = parseInt(document.querySelector('input[name="rating"]:checked')?.value);
            const comment = document.getElementById('rating-comment').value;

            if (!rating) {
                alert('Por favor, selecione uma avalia√ß√£o');
                return;
            }

            const appointment = stateManager.state.appointments.find(apt => apt.id === appointmentId);
            if (!appointment) {
                alert('Agendamento n√£o encontrado');
                return;
            }

            const reviewData = {
                appointmentId: appointmentId,
                professionalId: appointment.professionalId,
                clientName: appointment.clientName,
                rating: rating,
                comment: comment
            };

            stateManager.addReview(reviewData);
            stateManager.updateAppointmentStatus(appointmentId, 'rated');
            
            alert('‚úÖ Avalia√ß√£o enviada com sucesso! Obrigado por seu feedback.');
            closeRatingModal();
            renderView('appointments-page');
        }

        // Fun√ß√µes de navega√ß√£o
        function switchProfessionalTab(tab) {
            stateManager.setProfessionalTab(tab);
            renderView('professional-dashboard-page');
        }

        function viewProfessional(professionalId) {
            stateManager.state.bookingProfessionalId = professionalId;
            renderView('professional-profile-page');
        }

        function startBooking(professionalId) {
            if (!stateManager.state.currentUser) {
                alert('Por favor, fa√ßa login para agendar um servi√ßo.');
                renderView('login-page');
                return;
            }
            
            stateManager.state.bookingProfessionalId = professionalId;
            renderView('booking-page');
        }

        function performHomeSearch() {
            const searchTerm = document.getElementById('home-search-input').value;
            if (searchTerm) {
                renderView('search-page');
                // Em uma implementa√ß√£o real, isso filtraria os resultados
            } else {
                renderView('search-page');
            }
        }

        function performSearch() {
            const searchTerm = document.getElementById('search-input').value;
            // Em uma implementa√ß√£o real, isso filtraria os resultados
            console.log('Buscando por:', searchTerm);
        }

        function showFilters() {
            alert('Filtros ser√£o implementados em breve!');
        }

        // Fun√ß√µes para servi√ßos personalizados
        function addCustomService() {
            const customServiceInput = document.getElementById('custom-service');
            const serviceName = customServiceInput.value.trim();
            
            if (serviceName) {
                const customServicesList = document.getElementById('custom-services-list');
                const serviceId = 'custom-' + Date.now();
                
                const serviceElement = document.createElement('div');
                serviceElement.className = 'flex items-center bg-gray-100 px-3 py-1 rounded-full';
                serviceElement.innerHTML = `
                    <span class="text-sm mr-2">${serviceName}</span>
                    <button type="button" onclick="removeCustomService('${serviceId}')" class="text-red-500 hover:text-red-700">
                        <i data-lucide="x" class="w-3 h-3"></i>
                    </button>
                    <input type="hidden" name="custom-services" value="${serviceName}">
                `;
                serviceElement.id = serviceId;
                
                customServicesList.appendChild(serviceElement);
                customServiceInput.value = '';
                
                // Atualizar √≠cones
                if (window.lucide) {
                    lucide.createIcons();
                }
            }
        }

        function removeCustomService(serviceId) {
            const serviceElement = document.getElementById(serviceId);
            if (serviceElement) {
                serviceElement.remove();
            }
        }

        // Fun√ß√£o para lidar com upload de fotos
        function handlePhotoUpload(input) {
            const preview = document.getElementById('photo-preview');
            preview.innerHTML = '';
            
            if (input.files && input.files.length > 0) {
                const files = Array.from(input.files).slice(0, 5); // Limitar a 5 fotos
                
                files.forEach(file => {
                    if (file.type.startsWith('image/')) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            const imgContainer = document.createElement('div');
                            imgContainer.className = 'relative';
                            imgContainer.innerHTML = `
                                <img src="${e.target.result}" alt="Preview" class="w-full h-24 object-cover rounded-lg">
                                <button type="button" onclick="removePhoto(this)" class="absolute top-1 right-1 bg-red-500 text-white rounded-full p-1">
                                    <i data-lucide="x" class="w-3 h-3"></i>
                                </button>
                            `;
                            preview.appendChild(imgContainer);
                            
                            // Atualizar √≠cones
                            if (window.lucide) {
                                lucide.createIcons();
                            }
                        };
                        reader.readAsDataURL(file);
                    }
                });
            }
        }

        // Fun√ß√£o para remover foto do preview
        function removePhoto(button) {
            button.closest('.relative').remove();
        }

        // Fun√ß√£o para lidar com upload de foto de perfil
        function handleProfilePhotoUpload(input) {
            const preview = document.getElementById('profile-photo-preview');
            
            if (input.files && input.files[0]) {
                const file = input.files[0];
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        preview.innerHTML = `
                            <div class="relative inline-block">
                                <img src="${e.target.result}" alt="Preview" class="w-24 h-24 object-cover rounded-full">
                                <button type="button" onclick="removeProfilePhoto()" class="absolute top-0 right-0 bg-red-500 text-white rounded-full p-1">
                                    <i data-lucide="x" class="w-3 h-3"></i>
                                </button>
                            </div>
                        `;
                        
                        // Atualizar √≠cones
                        if (window.lucide) {
                            lucide.createIcons();
                        }
                    };
                    reader.readAsDataURL(file);
                }
            }
        }

        function removeProfilePhoto() {
            const preview = document.getElementById('profile-photo-preview');
            preview.innerHTML = '';
            document.getElementById('professional-profile-photo').value = '';
        }

        // Renderiza√ß√£o de views
        function renderView(viewName) {
            const container = document.getElementById('page-container');
            let content = '';
            
            switch(viewName) {
                case 'home-page':
                    content = getHomePageContent();
                    break;
                case 'search-page':
                    content = getSearchPageContent();
                    break;
                case 'login-page':
                    content = getLoginPageContent();
                    break;
                case 'professional-profile-page':
                    content = getProfessionalProfileContent();
                    break;
                case 'booking-page':
                    content = getBookingPageContent();
                    break;
                case 'appointments-page':
                    content = getAppointmentsPageContent();
                    break;
                case 'professional-dashboard-page':
                    content = getProfessionalDashboardContent();
                    break;
                case 'admin-dashboard-page':
                    content = getAdminDashboardContent();
                    break;
                default:
                    content = getHomePageContent();
                    break;
            }
            
            container.innerHTML = content;
            
            // Atualizar √≠cones Lucide
            if (window.lucide) {
                lucide.createIcons();
            }
            
            // Adicionar listeners para campos de profissional
            const userTypeRadios = document.querySelectorAll('input[name="userType"]');
            userTypeRadios.forEach(radio => {
                radio.addEventListener('change', function() {
                    const professionalFields = document.getElementById('professional-fields');
                    if (this.value === 'professional') {
                        professionalFields.classList.remove('hidden');
                    } else {
                        professionalFields.classList.add('hidden');
                    }
                });
            });
            
            // Adicionar listeners para upload de fotos
            const salonPhotoInput = document.getElementById('salon-photos');
            if (salonPhotoInput) {
                salonPhotoInput.addEventListener('change', function() {
                    handlePhotoUpload(this);
                });
            }
            
            const profilePhotoInput = document.getElementById('professional-profile-photo');
            if (profilePhotoInput) {
                profilePhotoInput.addEventListener('change', function() {
                    handleProfilePhotoUpload(this);
                });
            }
            
            // Atualizar summary do agendamento
            const bookingForm = document.getElementById('booking-form');
            if (bookingForm) {
                const updateSummary = () => {
                    const service = document.getElementById('booking-service').value;
                    const date = document.getElementById('booking-date').value;
                    const time = document.getElementById('booking-time').value;
                    
                    document.getElementById('summary-service').textContent = service || '-';
                    document.getElementById('summary-date').textContent = date ? new Date(date).toLocaleDateString('pt-BR') : '-';
                    document.getElementById('summary-time').textContent = time || '-';
                    
                    if (service && service.includes('-')) {
                        const price = service.split('-').pop().trim();
                        document.getElementById('summary-price').textContent = price;
                    }
                };
                
                document.getElementById('booking-service').addEventListener('change', updateSummary);
                document.getElementById('booking-date').addEventListener('change', updateSummary);
                document.getElementById('booking-time').addEventListener('change', updateSummary);
            }
            
            // Adicionar listeners para tabs do admin
            const professionalsTab = document.getElementById('professionals-tab');
            const appointmentsTab = document.getElementById('appointments-tab');
            
            if (professionalsTab) {
                professionalsTab.onclick = () => {
                    stateManager.setAdminTab('professionals');
                    renderView('admin-dashboard-page');
                };
            }
            
            if (appointmentsTab) {
                appointmentsTab.onclick = () => {
                    stateManager.setAdminTab('appointments');
                    renderView('admin-dashboard-page');
                };
            }
        }

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Inicializando WeCut...');
            
            // Inicializar state manager
            stateManager.init();
            
            // Inicializar √≠cones Lucide
            lucide.createIcons();
            
            // Inicializar listeners da navbar
            initNavbarListeners();
            
            // Atualizar UI de autentica√ß√£o
            updateAuthUI();
            
            // Renderizar p√°gina inicial
            renderView('home-page');
            
            console.log('‚úÖ WeCut inicializado com sucesso!');
            console.log('Usu√°rios dispon√≠veis:', stateManager.state.users);
        });
    </script>
</body>
</html>